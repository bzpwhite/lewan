{"version":3,"sources":["..\\..\\..\\..\\assets\\Sdk/assets\\Sdk\\sdk.js"],"names":["md5","require","mta","sdk_conf","aldgame","sdk","ip1","ip2","ip3","ip4","loginBg","loginBt","debug","login","Config","ConfigData","Share","ShareList","Logcommon","BannerAd","VideoAd","userid","init","args","callback","self","checkUpdate","cc","sys","platform","WECHAT_GAME","Get","d","c","d2","console","log","getUser","uid","option","wx","getLaunchOptionsSync","query","share_id","share_uid","Post","log_type","data","JSON","stringify","onShow","getSystemInfo","success","res","loginData","scene","getNetworkType","res2","network_type","networkType","getShareByWeight","type","length","tArray","i","weight","parseInt","push","iArray","j","Math","random","item","title","indexOf","replace","nickName","parse","onShareAppMessage","obj","showShareMenu","withShareTicket","tpye","shareInfo","imageUrl","sysid","fail","shareAppMessage","initmta","App","setmta","name","value","Event","stat","setAld","key","aldSendEvent","v1","v2","v3","url","reqData","game","version","ts","Date","getTime","sign","toString","substr","xhr","XMLHttpRequest","onreadystatechange","readyState","status","response","responseText","responseJson","open","send","param","setRequestHeader","getUpdateManager","updateManager","onCheckForUpdate","hasUpdate","onUpdateReady","applyUpdate","onUpdateFailed","getConfig1","config1","getConfig2","config2","createImage","sprite","image","onload","texture","Texture2D","initWithElement","handleLoadedTexture","spriteFrame","SpriteFrame","src","userinfo","getItem","setItem","localStorage","onMessage","postMessage","msg","message","setUserCloudStorage","kvDataList","KVDataList","getUserCloudStorage","keyList","getGroupCloudStorage","shareTicket","getFriendCloudStorage","sortList","ListData","field","order","sort","a","b","AMaxScore","BMaxScore","getMyRank3","me","dataList","avatarUrl","nickname","isSelf","rank","WeChatLogin","options","referee_id","source_id","source_id2","maskNode","Node","parent","director","getScene","getChildByName","addComponent","BlockInputEvents","sp","Sprite","opacity","color","Color","sizeMode","SizeMode","CUSTOM","width","view","getVisibleSize","height","button","show","createUserInfoButton","style","left","screenWidth","top","screenHeight","onTap","res1","showToast","icon","duration","getSetting","auths","authSetting","code","rawData","iv","encryptedData","signature","hideToast","destroy","hide","createBannerAd","phone","getSystemInfoSync","w","h","adUnitId","bannerAdUnitId","onResize","realWidth","realHeight","onLoad","onError","createRewardedVideoAd","videoAdUnitId","Screenshot","capture","authorize","scope","showModal","content","showCancel","openSetting","res3","ENGINE_VERSION","canvas","winSize","toTempFilePath","x","y","destWidth","destHeight","saveImageToPhotosAlbum","filePath","tempFilePath","cameraNode","camera","Camera","RenderTexture","gl","_renderContext","initWithSize","visibleRect","STENCIL_INDEX8","targetTexture","document","createElement","ctx","getContext","render","readPixels","rowBytes","row","srow","imageData","createImageData","start","putImageData","dataURL","toDataURL","toTempFilePathSync","window"],"mappings":";;;;;;AAAA;;;;;;;;;;;;;;;AAeA,IAAIA,MAAMC,QAAQ,KAAR,CAAV;AACA,IAAIC,MAAMD,QAAQ,KAAR,CAAV;AACA,IAAIE,WAAWF,QAAQ,UAAR,CAAf;AACA,IAAIG,UAAUH,QAAQ,UAAR,CAAd;AACA,IAAII,MAAM;AACNL,SAAKA,GADC;AAENE,SAAKA,GAFC;AAGNI,SAAK,+BAHC;AAINC,SAAK,8BAJC;AAKNC,SAAK,6BALC;AAMNC,SAAK,6BANC;AAONC,aAAS,6EAPH;AAQNC,aAAS,6EARH;;AAUNC,WAAO,KAVD,EAUO;;AAEbC,WAAO,eAZD;AAaNC,YAAQ,gBAbF;AAcNC,gBAAY;AACR,mBAAW,EADH;AAER,mBAAW;AAFH,KAdN;AAkBNC,WAAO,eAlBD;AAmBNC,eAAW,EAnBL;AAoBNC,eAAW,aApBL;;AAsBNC,cAAU,IAtBJ;AAuBNC,aAAS,IAvBH;;AAyBN;AACAC,YAAQ,CA1BF;;AA4BN;;;;;;;;;;;;;;;;;AAiBAC,QA7CM,gBA6CDC,IA7CC,EA6CKC,QA7CL,EA6Cc;AAChB,YAAIC,OAAO,IAAX;AACA,YAAGF,KAAKX,KAAR,EAAc;AACV,iBAAKA,KAAL,GAAaW,KAAKX,KAAlB;AACH;AACD,YAAGW,KAAKF,MAAR,EAAe;AACX,iBAAKA,MAAL,GAAcE,KAAKF,MAAnB;AACH;;AAED,aAAKK,WAAL;;AAEA,YAAIC,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxC;AACA,iBAAKC,GAAL,CAAS,KAAKxB,GAAL,GAAW,KAAKO,MAAzB,EAAiC,EAAjC,EAAqC,UAAUkB,CAAV,EAAa;AAC9C,oBAAIA,KAAKA,EAAEC,CAAF,IAAO,CAAhB,EAAmB;AACfR,yBAAKV,UAAL,GAAkBiB,EAAEA,CAApB;;AAEA;AACAP,yBAAKM,GAAL,CAASN,KAAKlB,GAAL,GAAWkB,KAAKT,KAAzB,EAAgC,EAAhC,EAAoC,UAAUkB,EAAV,EAAc;AAC9C;AACA,4BAAIA,MAAMA,GAAGD,CAAH,IAAQ,CAAlB,EAAqB;AACjBR,iCAAKR,SAAL,GAAiBiB,GAAGF,CAApB;AACH,yBAFD,MAEK;AACDG,oCAAQC,GAAR,CAAY,YAAZ,EAAyBF,EAAzB;AACH;AACDV,iCAAS,IAAT;AACH,qBARD;AASH,iBAbD,MAaK;AACD,wBAAGC,KAAKb,KAAR,EAAc;AACVuB,gCAAQC,GAAR,CAAY,oBAAZ,EAAiCJ,CAAjC;AACH;AACDP,yBAAKH,IAAL,CAAUC,IAAV,EAAgBC,QAAhB;AACH;AACJ,aApBD;;AAsBA,gBAAG,KAAKa,OAAL,EAAH,EAAkB;AACd,qBAAKhB,MAAL,GAAc,KAAKgB,OAAL,GAAeC,GAA7B;AACH;AACD,gBAAG,KAAKjB,MAAR,EAAe;AACX;AACA,oBAAIkB,SAASC,GAAGC,oBAAH,EAAb;AACA;AACA,oBAAGF,OAAOG,KAAP,CAAaC,QAAb,IAAyBJ,OAAOG,KAAP,CAAaJ,GAAzC,EAA6C;AACzCC,2BAAOG,KAAP,CAAaE,SAAb,GAAyBL,OAAOG,KAAP,CAAaJ,GAAtC;AACAC,2BAAOG,KAAP,CAAaJ,GAAb,GAAmB,KAAKjB,MAAxB;AACA;AACA,yBAAKwB,IAAL,CAAU,KAAKrC,GAAL,GAAW,KAAKU,SAA1B,EAAqC,EAAE4B,UAAU,YAAZ,EAA0BC,MAAMC,KAAKC,SAAL,CAAeV,MAAf,CAAhC,EAArC,EAA+F,UAAUP,CAAV,EAAa;AACxG;AACH,qBAFD;AAGH;AACDQ,mBAAGU,MAAH,CAAU,UAACX,MAAD,EAAU;AAChB;AACA,wBAAGA,OAAOG,KAAP,CAAaJ,GAAhB,EAAoB;AAChBC,+BAAOG,KAAP,CAAaE,SAAb,GAAyBL,OAAOG,KAAP,CAAaJ,GAAtC;AACAC,+BAAOG,KAAP,CAAaJ,GAAb,GAAmBb,KAAKJ,MAAxB;AACA;AACAI,6BAAKoB,IAAL,CAAUpB,KAAKjB,GAAL,GAAWiB,KAAKP,SAA1B,EAAqC,EAAE4B,UAAU,YAAZ,EAA0BC,MAAMC,KAAKC,SAAL,CAAeV,MAAf,CAAhC,EAArC,EAA+F,UAAUP,CAAV,EAAa;AACxG;AACH,yBAFD;AAGH;AACJ,iBAVD;;AAYA;AACAQ,mBAAGW,aAAH,CAAiB;AACbC,2BADa,mBACLC,GADK,EACD;AACR,4BAAIC,YAAYD,GAAhB;AACAC,kCAAUhB,GAAV,GAAgBb,KAAKJ,MAArB;AACAiC,kCAAUV,SAAV,GAAsBL,OAAOG,KAAP,CAAaE,SAAnC;AACAU,kCAAUC,KAAV,GAAkBhB,OAAOgB,KAAzB;AACAf,2BAAGgB,cAAH,CAAkB;AACdJ,mCADc,mBACNK,IADM,EACD;AACTH,0CAAUI,YAAV,GAAyBD,KAAKE,WAA9B;AACA;AACAlC,qCAAKM,GAAL,CAASN,KAAKjB,GAAL,GAAWiB,KAAKP,SAAzB,EAAoC,EAAE4B,UAAU,WAAZ,EAAyBC,MAAMC,KAAKC,SAAL,CAAeK,SAAf,CAA/B,EAApC,EAAgG,UAAUtB,CAAV,EAAa;AACzG;AACH,iCAFD;AAGH;AAPa,yBAAlB;AASH;AAfY,iBAAjB;AAiBH;AAEJ;AAGJ,KAlIK;;AAmIN;AACA4B,oBApIM,4BAoIWC,IApIX,EAoIgB;AAClB,YAAG,KAAK5C,SAAL,CAAe6C,MAAf,GAAwB,CAA3B,EAA6B;AACzB;AACA,gBAAIC,SAAS,EAAb;AACA,iBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAI,KAAK/C,SAAL,CAAe6C,MAAnC,EAA2CE,GAA3C,EAAgD;AAC5C,oBAAIH,QAAQ,KAAK5C,SAAL,CAAe+C,CAAf,EAAkBH,IAA9B,EAAoC;AAChC,yBAAK5C,SAAL,CAAe+C,CAAf,EAAkBC,MAAlB,GAA2BC,SAAS,KAAKjD,SAAL,CAAe+C,CAAf,EAAkBC,MAA3B,CAA3B;AACAF,2BAAOI,IAAP,CAAY,KAAKlD,SAAL,CAAe+C,CAAf,CAAZ;AACH;AACJ;AACD;AACA,gBAAII,SAAS,EAAb;AACA,iBAAK,IAAIJ,IAAI,CAAb,EAAgBA,IAAID,OAAOD,MAA3B,EAAmCE,GAAnC,EAAwC;AACpC,qBAAK,IAAIK,IAAI,CAAb,EAAgBA,IAAIN,OAAOC,CAAP,EAAUC,MAA9B,EAAsCI,GAAtC,EAA2C;AACvCD,2BAAOD,IAAP,CAAYH,CAAZ;AACH;AACJ;AACD,gBAAIA,IAAII,OAAOF,SAASI,KAAKC,MAAL,KAAgBH,OAAON,MAAhC,CAAP,CAAR;AACA;AACA,gBAAIU,OAAOT,OAAOC,CAAP,CAAX;AACA,gBAAGQ,KAAKC,KAAL,CAAWC,OAAX,CAAmB,WAAnB,KAAmC,CAAC,CAAvC,EAAyC;AACrCF,qBAAKC,KAAL,GAAaD,KAAKC,KAAL,CAAWE,OAAX,CAAmB,YAAnB,EAAiC,KAAKtC,OAAL,GAAeuC,QAAhD,CAAb;AACH;AACD,mBAAO5B,KAAK6B,KAAL,CAAW7B,KAAKC,SAAL,CAAeuB,IAAf,CAAX,CAAP;AACH,SAvBD,MAuBK;AACD,mBAAO,IAAP;AACH;AACJ,KA/JK;;AAgKN;;;;;;;;;;;;;;AAcAM,qBA9KM,6BA8KYC,GA9KZ,EA8KgB;AAClB,YAAItD,OAAO,IAAX;AACA,YAAIE,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxC;AACAU,eAAGwC,aAAH,CAAiB,EAACC,iBAAgB,IAAjB,EAAjB;AACAzC,eAAGsC,iBAAH,CAAqB,UAASzB,GAAT,EAAa;AAC9B;AACA,oBAAI6B,OAAO,CAAX;AACA,oBAAGH,IAAIlB,IAAP,EAAY;AACRqB,2BAAOH,IAAIlB,IAAX;AACH;AACD,oBAAIsB,YAAY1D,KAAKmC,gBAAL,CAAsBsB,IAAtB,CAAhB;;AAEA,oBAAGH,IAAIN,KAAP,EAAa;AACTU,8BAAUV,KAAV,GAAkBM,IAAIN,KAAtB;AACH;AACD,oBAAGM,IAAIK,QAAP,EAAgB;AACZD,8BAAUC,QAAV,GAAqBL,IAAIK,QAAzB;AACH;AACD,oBAAGD,UAAUzC,KAAb,EAAmB;AACfyC,8BAAUzC,KAAV,IAAmBqC,IAAIrC,KAAJ,GAAY,YAAZ,GAAyByC,UAAUE,KAAnC,GAA2C,OAA3C,GAAmD5D,KAAKJ,MAA3E;AACH,iBAFD,MAEK;AACD,wBAAG0D,IAAIrC,KAAP,EAAa;AACTyC,kCAAUzC,KAAV,GAAkB,cAAYyC,UAAUE,KAAtB,GAA4B,OAA5B,GAAoC5D,KAAKJ,MAAzC,GAAiD,GAAjD,GAAuD0D,IAAIrC,KAA7E;AACH,qBAFD,MAEK;AACDyC,kCAAUzC,KAAV,GAAkB,cAAYyC,UAAUE,KAAtB,GAA8B,OAA9B,GAAsC5D,KAAKJ,MAA7D;AACH;AACJ;AACD,oBAAG0D,IAAI3B,OAAP,EAAe;AACX+B,8BAAU/B,OAAV,GAAoB2B,IAAI3B,OAAxB;AACH;AACD,oBAAG2B,IAAIO,IAAP,EAAY;AACRH,8BAAUG,IAAV,GAAiBP,IAAIO,IAArB;AACH;;AAED;AACA,oBAAI/C,SAAS,EAAC,OAAOlC,IAAIgB,MAAZ,EAAoB,YAAY8D,UAAUE,KAA1C,EAAb;AACA;AACA5D,qBAAKM,GAAL,CAASN,KAAKjB,GAAL,GAAWiB,KAAKP,SAAzB,EAAoC,EAAE4B,UAAU,YAAZ,EAA0BC,MAAMC,KAAKC,SAAL,CAAeV,MAAf,CAAhC,EAApC,EAA8F,UAAUP,CAAV,EAAa;AACvG;AACH,iBAFD;;AAIA,uBAAOmD,SAAP;AACH,aAtCD;AAuCH;AACJ,KA3NK;;AA4NN;;;;;;;;;;;;;;AAcAI,mBA1OM,2BA0OUR,GA1OV,EA0Oc;AAChB,YAAItD,OAAO,IAAX;AACA;AACA,YAAIyD,OAAO,CAAX;AACA,YAAGH,IAAIlB,IAAP,EAAY;AACRqB,mBAAOH,IAAIlB,IAAX;AACH;AACD,YAAIsB,YAAY,KAAKvB,gBAAL,CAAsBsB,IAAtB,CAAhB;AACA,YAAGH,IAAIN,KAAP,EAAa;AACTU,sBAAUV,KAAV,GAAkBM,IAAIN,KAAtB;AACH;AACD,YAAGM,IAAIK,QAAP,EAAgB;AACZD,sBAAUC,QAAV,GAAqBL,IAAIK,QAAzB;AACH;AACD,YAAGD,UAAUzC,KAAb,EAAmB;AACfyC,sBAAUzC,KAAV,IAAmBqC,IAAIrC,KAAJ,GAAY,YAAZ,GAAyByC,UAAUE,KAAnC,GAA2C,OAA3C,GAAmD5D,KAAKJ,MAA3E;AACH,SAFD,MAEK;AACD,gBAAG0D,IAAIrC,KAAP,EAAa;AACTyC,0BAAUzC,KAAV,GAAkB,cAAYyC,UAAUE,KAAtB,GAA4B,OAA5B,GAAoC5D,KAAKJ,MAAzC,GAAiD,GAAjD,GAAuD0D,IAAIrC,KAA7E;AACH,aAFD,MAEK;AACDyC,0BAAUzC,KAAV,GAAkB,cAAYyC,UAAUE,KAAtB,GAA8B,OAA9B,GAAsC5D,KAAKJ,MAA7D;AACH;AACJ;AACD,YAAG0D,IAAI3B,OAAP,EAAe;AACX+B,sBAAU/B,OAAV,GAAoB2B,IAAI3B,OAAxB;AACH;AACD,YAAG2B,IAAIO,IAAP,EAAY;AACRH,sBAAUG,IAAV,GAAiBP,IAAIO,IAArB;AACH;AACDnD,gBAAQC,GAAR,CAAY,eAAZ,EAA6B+C,SAA7B;AACA,YAAIxD,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxCU,eAAG+C,eAAH,CAAmBJ,SAAnB;;AAEA;AACA,gBAAI5C,SAAS,EAAC,OAAOlC,IAAIgB,MAAZ,EAAoB,YAAY8D,UAAUE,KAA1C,EAAb;AACA;AACA5D,iBAAKM,GAAL,CAASN,KAAKjB,GAAL,GAAWiB,KAAKP,SAAzB,EAAoC,EAAE4B,UAAU,YAAZ,EAA0BC,MAAMC,KAAKC,SAAL,CAAeV,MAAf,CAAhC,EAApC,EAA8F,UAAUP,CAAV,EAAa;AACvG;AACH,aAFD;AAGH;AACJ,KAlRK;;;AAqRN;;;;;;;;;;;;;;;;;;;;;;;AAuBAwD,WA5SM,mBA4SEjE,IA5SF,EA4SO;AACTrB,YAAIuF,GAAJ,CAAQnE,IAAR,CAAaC,IAAb;AACA;AACA;AACA;AACH,KAjTK;;AAkTN;;;;;;;;;;;AAWAmE,UA7TM,kBA6TCC,IA7TD,EA6TOC,KA7TP,EA6Ta;AACf,YAAIjE,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxC5B,gBAAI2F,KAAJ,CAAUC,IAAV,CAAeH,IAAf,EAAqB,EAAEC,OAAO,MAAT,EAArB;AACH;AACJ,KAjUK;;AAkUN;;;;;;;;;;;;;AAaAG,UA/UM,kBA+UClC,IA/UD,EA+UOmC,GA/UP,EA+UYJ,KA/UZ,EA+UkB;AACpB,YAAIjE,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxC;AACAU,eAAGyD,YAAH,CAAgBC,EAAhB,EAAqB,EAAEC,IAAKC,EAAP,EAArB;AACH;AACJ,KApVK;;;AAsVN;;;;;;;;;;;;;AAaArE,OAnWM,eAmWFsE,GAnWE,EAmWGC,OAnWH,EAmWY9E,QAnWZ,EAmWsB;AACxB,YAAIC,OAAO,IAAX;;AAEA6E,gBAAQC,IAAR,GAAepG,SAASoG,IAAxB;AACAD,gBAAQE,OAAR,GAAkBrG,SAASqG,OAA3B;AACA,YAAIC,KAAK,IAAIC,IAAJ,GAAWC,OAAX,EAAT;AACAL,gBAAQG,EAAR,GAAaA,EAAb;AACA;AACAH,gBAAQM,IAAR,GAAe5G,IAAIyG,GAAGI,QAAH,GAAcC,MAAd,CAAqB,CAArB,EAAuB,CAAvB,IAA0B3G,SAASoG,IAAT,CAAcO,MAAd,CAAqB,CAArB,EAAuB,CAAvB,CAA1B,GAAoD3G,SAASqG,OAAT,CAAiBM,MAAjB,CAAwB,CAAxB,EAA0B,CAA1B,CAApD,GAAkF,oBAAtF,CAAf;;AAEAT,eAAO,GAAP;AACA,aAAK,IAAI7B,IAAT,IAAiB8B,OAAjB,EAA0B;AACtBD,mBAAO7B,OAAO,GAAP,GAAa8B,QAAQ9B,IAAR,CAAb,GAA6B,GAApC;AACH;AACD,YAAIuC,MAAM,IAAIC,cAAJ,EAAV;AACAD,YAAIE,kBAAJ,GAAyB,YAAY;AACjC,gBAAIF,IAAIG,UAAJ,IAAkB,CAAtB,EAAyB;AACrB,oBAAIH,IAAII,MAAJ,IAAc,GAAd,IAAqBJ,IAAII,MAAJ,GAAa,GAAtC,EAA2C;AACvC,wBAAIC,WAAWL,IAAIM,YAAnB;AACA,wBAAID,QAAJ,EAAc;AACV,4BAAIE,eAAetE,KAAK6B,KAAL,CAAWuC,QAAX,CAAnB;AACA5F,iCAAS8F,YAAT;AACH,qBAHD,MAGO;AACH,4BAAG7F,KAAKb,KAAR,EAAc;AACVuB,oCAAQC,GAAR,CAAY,SAAZ,EAAsBiE,GAAtB;AACH;AACD7E,iCAAS,IAAT;AACH;AACJ,iBAXD,MAWO;AACH,wBAAGC,KAAKb,KAAR,EAAc;AACVuB,gCAAQC,GAAR,CAAY,MAAZ,EAAmBiE,GAAnB;AACH;AACD7E,6BAAS,IAAT;AACH;AACJ;AACJ,SApBD;AAqBAuF,YAAIQ,IAAJ,CAAS,KAAT,EAAgBlB,GAAhB,EAAqB,IAArB;AACAU,YAAIS,IAAJ;AACH,KAzYK;;AA0YN;;;;;;;;;;;;;AAaA3E,UAAM,cAAUwD,GAAV,EAAeC,OAAf,EAAwB9E,QAAxB,EAAkC;AACpC,YAAIC,OAAO,IAAX;;AAEA6E,gBAAQC,IAAR,GAAepG,SAASoG,IAAxB;AACAD,gBAAQE,OAAR,GAAkBrG,SAASqG,OAA3B;AACA,YAAIC,KAAK,IAAIC,IAAJ,GAAWC,OAAX,EAAT;AACAL,gBAAQG,EAAR,GAAaA,EAAb;AACAH,gBAAQM,IAAR,GAAe5G,IAAIyG,GAAGI,QAAH,GAAcC,MAAd,CAAqB,CAArB,EAAuB,CAAvB,IAA0B3G,SAASoG,IAAT,CAAcO,MAAd,CAAqB,CAArB,EAAuB,CAAvB,CAA1B,GAAoD3G,SAASqG,OAAT,CAAiBM,MAAjB,CAAwB,CAAxB,EAA0B,CAA1B,CAApD,GAAkF,oBAAtF,CAAf;;AAEA;AACA,YAAIW,QAAQ,EAAZ;AACA,aAAK,IAAIjD,IAAT,IAAiB8B,OAAjB,EAA0B;AACtBmB,qBAASjD,OAAO,GAAP,GAAa8B,QAAQ9B,IAAR,CAAb,GAA6B,GAAtC;AACH;AACD;AACA,YAAIuC,MAAM,IAAIC,cAAJ,EAAV;AACAD,YAAIE,kBAAJ,GAAyB,YAAY;AACjC,gBAAIF,IAAIG,UAAJ,IAAkB,CAAtB,EAAyB;AACrB,oBAAIH,IAAII,MAAJ,IAAc,GAAd,IAAqBJ,IAAII,MAAJ,GAAa,GAAtC,EAA2C;AACvC,wBAAIC,WAAWL,IAAIM,YAAnB;AACA;AACA,wBAAID,QAAJ,EAAc;AACV,4BAAIE,eAAetE,KAAK6B,KAAL,CAAWuC,QAAX,CAAnB;AACA5F,iCAAS8F,YAAT;AACH,qBAHD,MAGO;AACH,4BAAG7F,KAAKb,KAAR,EAAc;AACVuB,oCAAQC,GAAR,CAAY,SAAZ;AACH;AACDZ,iCAAS,IAAT;AACH;AACJ,iBAZD,MAYO;AACH,wBAAGC,KAAKb,KAAR,EAAc;AACVuB,gCAAQC,GAAR,CAAY,MAAZ,EAAmB2E,GAAnB;AACH;AACDvF,6BAAS,IAAT;AACH;AACJ;AACJ,SArBD;AAsBAuF,YAAIQ,IAAJ,CAAS,MAAT,EAAiBlB,GAAjB,EAAsB,IAAtB;AACAU,YAAIW,gBAAJ,CAAqB,cAArB,EAAqC,mCAArC;AACAX,YAAIS,IAAJ,CAASC,KAAT,EAxCoC,CAwCpB;AACnB,KAhcK;AAicN;;;;;;;;AAQA/F,eAzcM,yBAycQ;AACV,YAAID,OAAO,IAAX;AACA,YAAIE,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA3B,IAA0C,OAAOU,GAAGmF,gBAAV,KAA+B,UAA7E,EAAyF;AACrF,gBAAMC,gBAAgBpF,GAAGmF,gBAAH,EAAtB;AACAC,0BAAcC,gBAAd,CAA+B,UAAUxE,GAAV,EAAe;AAC1C,oBAAG5B,KAAKb,KAAR,EAAc;AACVuB,4BAAQC,GAAR,CAAY,aAAZ,EAA2BiB,IAAIyE,SAA/B;AACH;AACJ,aAJD;AAKAF,0BAAcG,aAAd,CAA4B,YAAY;AACpC,oBAAGtG,KAAKb,KAAR,EAAc;AACVuB,4BAAQC,GAAR,CAAY,mCAAZ;AACH;AACDwF,8BAAcI,WAAd;AACH,aALD;AAMAJ,0BAAcK,cAAd,CAA6B,YAAY;AACrC,oBAAGxG,KAAKb,KAAR,EAAc;AACVuB,4BAAQC,GAAR,CAAY,UAAZ;AACH;AACJ,aAJD;AAKH;AACJ,KA9dK;;AA+dN;;;;;;;;;AASA8F,cAxeM,wBAweM;AACR,eAAOlF,KAAK6B,KAAL,CAAW,KAAK9D,UAAL,CAAgBoH,OAA3B,CAAP;AACH,KA1eK;;AA2eN;;;;;;;;;AASAC,cApfM,wBAofM;AACR,eAAOpF,KAAK6B,KAAL,CAAW,KAAK9D,UAAL,CAAgBsH,OAA3B,CAAP;AACH,KAtfK;;;AAyfN;;;;;;;;;;AAUAC,eAngBM,uBAmgBMC,MAngBN,EAmgBclC,GAngBd,EAmgBmB;AACrB,YAAI1E,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxC,gBAAI0G,QAAQhG,GAAG8F,WAAH,EAAZ;AACAE,kBAAMC,MAAN,GAAe,YAAY;AACvB,oBAAIC,UAAU,IAAI/G,GAAGgH,SAAP,EAAd;AACAD,wBAAQE,eAAR,CAAwBJ,KAAxB;AACAE,wBAAQG,mBAAR;AACAN,uBAAOO,WAAP,GAAqB,IAAInH,GAAGoH,WAAP,CAAmBL,OAAnB,CAArB;AACH,aALD;AAMAF,kBAAMQ,GAAN,GAAY3C,GAAZ;AACH;AAEJ,KA/gBK;;AAghBN;;;;;;;;;AASAhE,WAzhBM,qBAyhBG;AACL,YAAI4G,WAAW,KAAKC,OAAL,CAAa,UAAb,CAAf;AACA,YAAGD,QAAH,EAAY;AACR,mBAAOjG,KAAK6B,KAAL,CAAWoE,QAAX,CAAP;AACH,SAFD,MAEK;AACD,mBAAO,IAAP;AACH;AACJ,KAhiBK;;AAiiBN;;;;;;;;;;AAUAE,WA3iBM,mBA2iBEnD,GA3iBF,EA2iBOJ,KA3iBP,EA2iBa;AACfjE,WAAGC,GAAH,CAAOwH,YAAP,CAAoBD,OAApB,CAA4BnD,GAA5B,EAAiCJ,KAAjC;AACH,KA7iBK;;AA8iBN;;;;;;;;;;AAUAsD,WAxjBM,mBAwjBElD,GAxjBF,EAwjBM;AACR,eAAOrE,GAAGC,GAAH,CAAOwH,YAAP,CAAoBF,OAApB,CAA4BlD,GAA5B,CAAP;AACH,KA1jBK;;AA2jBN;;;;;;;;;;;AAWAqD,aAtkBM,qBAskBI7H,QAtkBJ,EAskBa;AACf,YAAIG,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxCU,eAAG6G,SAAH,CAAa,UAASrH,CAAT,EAAW;AACpB;AACA;AACA;AACAR,yBAASQ,CAAT;AACH,aALD;AAMH;AACJ,KA/kBK;;AAglBN;;;;;;;;;AASAsH,eAzlBM,uBAylBMC,GAzlBN,EAylBU;AACZ,YAAI5H,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxCU,eAAG8G,WAAH,CAAe,EAAEE,SAASD,GAAX,EAAf;AACH;AACJ,KA7lBK;;AA8lBN;AACAE,uBA/lBM,+BA+lBcC,UA/lBd,EA+lB0BlI,QA/lB1B,EA+lBmC;AACrC,YAAIG,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxCU,eAAGiH,mBAAH,CAAuB;AACnBE,4BAAYD,UADO;AAEnBtG,uBAFmB,mBAEXC,GAFW,EAEP;AACR7B,6BAAS6B,GAAT;AACH,iBAJkB;AAKnBiC,oBALmB,gBAKdjC,GALc,EAKV;AACL7B,6BAAS6B,GAAT;AACH;AAPkB,aAAvB;AASH;AACJ,KA3mBK;;AA4mBN;AACAuG,uBA7mBM,+BA6mBcC,OA7mBd,EA6mBuBrI,QA7mBvB,EA6mBgC;AAClC,YAAIG,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxCU,eAAGoH,mBAAH,CAAuB;AACnBC,yBAASA,OADU;AAEnBzG,uBAFmB,mBAEXC,GAFW,EAEP;AACR7B,6BAAS6B,GAAT;AACH,iBAJkB;AAKnBiC,oBALmB,gBAKdjC,GALc,EAKV;AACL7B,6BAAS6B,GAAT;AACH;AAPkB,aAAvB;AASH;AACJ,KAznBK;;AA0nBN;AACAyG,wBA3nBM,gCA2nBeC,WA3nBf,EA2nB4BF,OA3nB5B,EA2nBqCrI,QA3nBrC,EA2nB8C;AAChD,YAAIG,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxCU,eAAGsH,oBAAH,CAAwB;AACpBC,6BAAaA,WADO;AAEpBF,yBAASA,OAFW;AAGpBzG,uBAHoB,mBAGZC,GAHY,EAGR;AACR7B,6BAAS6B,GAAT;AACH,iBALmB;AAMpBiC,oBANoB,gBAMfjC,GANe,EAMX;AACL7B,6BAAS6B,GAAT;AACH;AARmB,aAAxB;AAUH;AACJ,KAxoBK;;AAyoBN;AACA2G,yBA1oBM,iCA0oBgBH,OA1oBhB,EA0oByBrI,QA1oBzB,EA0oBkC;AACpC,YAAIG,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxCU,eAAGwH,qBAAH,CAAyB;AACrBH,yBAASA,OADY;AAErBzG,uBAFqB,mBAEbC,GAFa,EAET;AACR7B,6BAAS6B,GAAT;AACH,iBAJoB;AAKrBiC,oBALqB,gBAKhBjC,GALgB,EAKZ;AACL7B,6BAAS6B,GAAT;AACH;AAPoB,aAAzB;AASH;AACJ,KAtpBK;;AAupBN;;;;;;;;;;;;;;;;;;;;AAoBA4G,YA3qBM,oBA2qBGC,QA3qBH,EA2qBaC,KA3qBb,EA2qBoBC,KA3qBpB,EA2qB0B;AAC5BF,iBAASG,IAAT,CAAc,UAASC,CAAT,EAAWC,CAAX,EAAa;AACvB,gBAAIC,YAAY,CAAhB;AACA,gBAAIb,aAAaW,EAAEX,UAAnB;AACA,iBAAI,IAAI3F,IAAE,CAAV,EAAaA,IAAE2F,WAAW7F,MAA1B,EAAkCE,GAAlC,EAAsC;AAClC,oBAAG2F,WAAW3F,CAAX,EAAcgC,GAAd,IAAqBmE,KAAxB,EAA8B;AAC1BK,gCAAYb,WAAW3F,CAAX,EAAc4B,KAA1B;AACH;AACJ;;AAED,gBAAI6E,YAAY,CAAhB;AACAd,yBAAaY,EAAEZ,UAAf;AACA,iBAAI,IAAI3F,IAAE,CAAV,EAAaA,IAAE2F,WAAW7F,MAA1B,EAAkCE,GAAlC,EAAsC;AAClC,oBAAG2F,WAAW3F,CAAX,EAAcgC,GAAd,IAAqBmE,KAAxB,EAA8B;AAC1BM,gCAAYd,WAAW3F,CAAX,EAAc4B,KAA1B;AACH;AACJ;;AAED,gBAAGwE,KAAH,EAAS;AACL,uBAAOlG,SAASsG,SAAT,IAAsBtG,SAASuG,SAAT,CAA7B;AACH,aAFD,MAEK;AACD,uBAAOvG,SAASuG,SAAT,IAAsBvG,SAASsG,SAAT,CAA7B;AACH;AACJ,SAtBD;AAuBA,eAAON,QAAP;AACH,KApsBK;;AAqsBN;;;;;;;;;;;;;;;;;;;;;;;;AAwBAQ,cA7tBM,sBA6tBKR,QA7tBL,EA6tBcS,EA7tBd,EA6tBiB;AACnB,YAAIC,WAAW,EAAf;AACA,aAAI,IAAI5G,IAAE,CAAV,EAAaA,IAAEkG,SAASpG,MAAxB,EAAgCE,GAAhC,EAAoC;AAChC,gBAAGkG,SAASpG,MAAT,IAAmB,CAAtB,EAAwB;AACpB;AACA,oBAAGoG,SAASlG,CAAT,EAAY6G,SAAZ,IAAyBF,GAAGE,SAA5B,IAAyCX,SAASlG,CAAT,EAAY8G,QAAZ,IAAwBH,GAAG/F,QAAvE,EAAgF;AAC5EsF,6BAASlG,CAAT,EAAY+G,MAAZ,GAAqB,IAArB,CAD4E,CAClD;AAC7B;AACDH,2BAAWV,QAAX;AACA,qBAAI,IAAIlG,IAAE,CAAV,EAAaA,IAAE4G,SAAS9G,MAAxB,EAAgCE,GAAhC,EAAoC;AAChC4G,6BAAS5G,CAAT,EAAYgH,IAAZ,GAAmBhH,CAAnB;AACH;AACJ,aATD,MASK;AACD,oBAAGkG,SAASlG,CAAT,EAAY6G,SAAZ,IAAyBF,GAAGE,SAA5B,IAAyCX,SAASlG,CAAT,EAAY8G,QAAZ,IAAwBH,GAAG/F,QAAvE,EAAgF;AAC5EsF,6BAASlG,CAAT,EAAY+G,MAAZ,GAAqB,IAArB,CAD4E,CAClD;AAC1B,wBAAG/G,KAAKkG,SAASpG,MAAT,GAAgB,CAAxB,EAA0B;AACtB;AACAoG,iCAASlG,CAAT,EAAYgH,IAAZ,GAAmBhH,CAAnB;AACAkG,iCAASlG,IAAE,CAAX,EAAcgH,IAAd,GAAqBhH,IAAE,CAAvB;AACAkG,iCAASlG,IAAE,CAAX,EAAcgH,IAAd,GAAqBhH,IAAE,CAAvB;AACA4G,iCAASzG,IAAT,CAAc+F,SAASlG,IAAE,CAAX,CAAd;AACA4G,iCAASzG,IAAT,CAAc+F,SAASlG,IAAE,CAAX,CAAd;AACA4G,iCAASzG,IAAT,CAAc+F,SAASlG,CAAT,CAAd;AACH,qBARD,MAQM,IAAGA,KAAG,CAAN,EAAQ;AACV;AACAkG,iCAASlG,CAAT,EAAYgH,IAAZ,GAAmBhH,CAAnB;AACAkG,iCAASlG,IAAE,CAAX,EAAcgH,IAAd,GAAqBhH,IAAE,CAAvB;AACAkG,iCAASlG,IAAE,CAAX,EAAcgH,IAAd,GAAqBhH,IAAE,CAAvB;AACA4G,iCAASzG,IAAT,CAAc+F,SAASlG,CAAT,CAAd;AACA4G,iCAASzG,IAAT,CAAc+F,SAASlG,IAAE,CAAX,CAAd;AACA4G,iCAASzG,IAAT,CAAc+F,SAASlG,IAAE,CAAX,CAAd;AACH,qBARK,MAQD;AACD;AACAkG,iCAASlG,IAAE,CAAX,EAAcgH,IAAd,GAAqBhH,IAAE,CAAvB;AACAkG,iCAASlG,CAAT,EAAYgH,IAAZ,GAAmBhH,CAAnB;AACAkG,iCAASlG,IAAE,CAAX,EAAcgH,IAAd,GAAqBhH,IAAE,CAAvB;AACA4G,iCAASzG,IAAT,CAAc+F,SAASlG,IAAE,CAAX,CAAd;AACA4G,iCAASzG,IAAT,CAAc+F,SAASlG,CAAT,CAAd;AACA4G,iCAASzG,IAAT,CAAc+F,SAASlG,IAAE,CAAX,CAAd;AACH;AACD;AACH;AACJ;AAEJ;AACD,eAAO4G,QAAP;AACH,KA3wBK;;AA4wBN;;;;;;;;;;;;;;;;;;;;AAoBAK,eAhyBM,uBAgyBMzJ,QAhyBN,EAgyBe;AACjB,YAAIC,OAAO,IAAX;AACA,YAAIE,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxC,gBAAIoJ,UAAU1I,GAAGC,oBAAH,EAAd;;AAEA,gBAAI0I,aAAaD,QAAQxI,KAAR,CAAcJ,GAA/B,CAHwC,CAGQ;AAChD,gBAAI8I,YAAYF,QAAQxI,KAAR,CAAc0I,SAA9B,CAJwC,CAIQ;AAChD,gBAAIC,aAAaH,QAAQxI,KAAR,CAAc2I,UAA/B,CALwC,CAKQ;AAChD,gBAAI1I,WAAWuI,QAAQxI,KAAR,CAAcC,QAA7B,CANwC,CAMQ;;AAEhD,gBAAIsG,WAAW,KAAK5G,OAAL,EAAf;;AAEA,gBAAG4G,QAAH,EAAY;AACRzH,yBAASyH,QAAT;AACH,aAFD,MAEK;AACD;AACA,oBAAIqC,WAAW,IAAI3J,GAAG4J,IAAP,CAAY,QAAZ,CAAf;AACAD,yBAASE,MAAT,GAAkB7J,GAAG8J,QAAH,CAAYC,QAAZ,GAAuBC,cAAvB,CAAsC,QAAtC,CAAlB;AACAL,yBAASM,YAAT,CAAsBjK,GAAGkK,gBAAzB;AACA,oBAAIC,KAAKR,SAASM,YAAT,CAAsBjK,GAAGoK,MAAzB,CAAT;AACAT,yBAASU,OAAT,GAAmB,GAAnB;AACAV,yBAASW,KAAT,GAAiB,IAAItK,GAAGuK,KAAP,CAAa,EAAb,EAAgB,EAAhB,EAAmB,EAAnB,EAAsB,GAAtB,CAAjB;AACAJ,mBAAGK,QAAH,GAAcxK,GAAGoK,MAAH,CAAUK,QAAV,CAAmBC,MAAjC;AACA5K,qBAAK6G,WAAL,CAAiBwD,EAAjB,EAAqBrK,KAAKf,OAA1B;AACA4K,yBAASgB,KAAT,GAAiB3K,GAAG4K,IAAH,CAAQC,cAAR,GAAyBF,KAA1C;AACAhB,yBAASmB,MAAT,GAAkB9K,GAAG4K,IAAH,CAAQC,cAAR,GAAyBC,MAA3C;AACA;;AAEA;AACA,oBAAGhL,KAAKiL,MAAR,EAAe;AACXjL,yBAAKiL,MAAL,CAAYC,IAAZ;AACH,iBAFD,MAEK;AACDnK,uBAAGW,aAAH,CAAiB;AACbC,+BADa,mBACLC,GADK,EACD;AACR,gCAAIiJ,QAAQ,MAAI,CAAhB;AACA,gCAAIG,SAAS,MAAI,CAAjB;AACAhL,iCAAKiL,MAAL,GAAclK,GAAGoK,oBAAH,CAAwB;AAClC/I,sCAAM,OAD4B;AAElC2E,uCAAO/G,KAAKd,OAFsB;AAGlCkM,uCAAO,EAAGP,OAAOA,KAAV,EAAiBG,QAAQA,MAAzB,EAAiCK,MAAMzJ,IAAI0J,WAAJ,GAAgB,CAAhB,GAAkBT,QAAM,CAA/D,EAAkEU,KAAK3J,IAAI4J,YAAJ,GAAiB,CAAjB,GAAmBR,SAAO,CAAjG;AAH2B,6BAAxB,CAAd;AAKAhL,iCAAKiL,MAAL,CAAYQ,KAAZ,CAAkB,UAACC,IAAD,EAAU;AACxB;AACA;AACA;AACA;AACA3K,mCAAG4K,SAAH,CAAa,EAAC3I,OAAO,QAAR,EAAiB4I,MAAK,SAAtB,EAAgCC,UAAU,CAA1C,EAAb;AACA9K,mCAAG+K,UAAH,CAAc;AACVnK,2CADU,mBACFoK,KADE,EACI;AACV,4CAAGA,MAAMC,WAAN,CAAkB,gBAAlB,CAAH,EAAuC;AACnCtL,oDAAQC,GAAR,CAAY,YAAZ;AACAI,+CAAG3B,KAAH,CAAS;AACLuC,uDADK,mBACGK,IADH,EACQ;AACT,wDAAI6C,UAAU;AACVoH,8DAAMjK,KAAKiK,IADD;AAEVC,iEAASR,KAAKQ,OAFJ;AAGVC,4DAAIT,KAAKS,EAHC;AAIVC,uEAAeV,KAAKU,aAJV;AAKVC,mEAAWX,KAAKW,SALN;;AAOV3C,oEAAYA,UAPF;AAQVC,mEAAWA,SARD;AASVC,oEAAYA,UATF;AAUV1I,kEAAUA;AAEd;AAZc,qDAAd,CAaAlB,KAAKoB,IAAL,CAAUpB,KAAKnB,GAAL,GAAWmB,KAAKZ,KAA1B,EAAiCyF,OAAjC,EAA0C,UAASvD,IAAT,EAAc;AACpD;AACA,4DAAGA,KAAKd,CAAL,IAAU,CAAb,EAAe;AACXR,iEAAK0H,OAAL,CAAa,UAAb,EAAyBnG,KAAKC,SAAL,CAAeF,KAAKf,CAApB,CAAzB;AACAQ,+DAAGuL,SAAH;AACAzC,qEAAS0C,OAAT;AACAvM,iEAAKiL,MAAL,CAAYuB,IAAZ;AACA;AACAxM,iEAAKJ,MAAL,GAAc0B,KAAKf,CAAL,CAAOM,GAArB;AACAb,iEAAKH,IAAL,CAAU,EAAV,EAAa,UAACU,CAAD,EAAK,CAAE,CAApB;;AAEAR,qEAASuB,KAAKf,CAAd;AACH,yDAVD,MAUK;AACD;AACAQ,+DAAG4K,SAAH,CAAa,EAAC3I,OAAO,SAAR,EAAb;AACH;AACJ,qDAhBD;AAiBH,iDAhCI;AAiCLa,oDAjCK,kBAiCC;AACF9C,uDAAG4K,SAAH,CAAa,EAAC3I,OAAO,SAAR,EAAb;AACAjD,6DAAS,KAAT;AACH;AApCI,6CAAT;AAsCH,yCAxCD,MAwCK;AACDA,qDAAS,KAAT;AACH;AACJ;AA7CS,iCAAd;AA+CH,6BArDD;AAsDAC,iCAAKiL,MAAL,CAAYC,IAAZ;AACH;AAhEY,qBAAjB;AAkEH;AACJ;AACJ;AACJ,KAr4BK;;AAs4BN;;;;;;;;;;;;;;;;;;;;;;;AAuBAuB,kBA75BM,0BA65BSnJ,GA75BT,EA65Ba;AACf,YAAItD,OAAO,IAAX;AACA,YAAIE,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxC,gBAAG,KAAKX,QAAR,EAAiB;AACb,uBAAO,KAAKA,QAAZ;AACH,aAFD,MAEK;AACD,oBAAG,CAAC4D,IAAI8H,KAAR,EAAc;AACV9H,wBAAI8H,KAAJ,GAAY,EAAZ;AACA,wBAAIsB,QAAQ3L,GAAG4L,iBAAH,EAAZ;AACA,yBAAKC,CAAL,GAASF,MAAMpB,WAAN,GAAoB,CAA7B;AACA,yBAAKuB,CAAL,GAASH,MAAMlB,YAAf;AACAlI,wBAAI8H,KAAJ,CAAUC,IAAV,GAAiB,CAAjB;AACA/H,wBAAI8H,KAAJ,CAAUG,GAAV,GAAgB,CAAhB;AACAjI,wBAAI8H,KAAJ,CAAUP,KAAV,GAAkB,GAAlB;AACH;AACD,qBAAKnL,QAAL,GAAgBqB,GAAG0L,cAAH,CAAkB;AAC9BK,8BAAUpO,SAASqO,cADW;AAE9B3B,2BAAO9H,IAAI8H;AAFmB,iBAAlB,CAAhB;AAIA,qBAAK1L,QAAL,CAAcsN,QAAd,CAAuB,UAASpL,GAAT,EAAa;AAChClB,4BAAQC,GAAR,CAAY,iBAAZ,EAA+BiB,GAA/B;AACA5B,yBAAKN,QAAL,CAAc0L,KAAd,CAAoBC,IAApB,GAA2BrL,KAAK4M,CAAL,GAAS5M,KAAKN,QAAL,CAAc0L,KAAd,CAAoB6B,SAApB,GAA8B,CAAvC,GAAyC,GAApE;AACAjN,yBAAKN,QAAL,CAAc0L,KAAd,CAAoBG,GAApB,GAA0BvL,KAAK6M,CAAL,GAAS7M,KAAKN,QAAL,CAAc0L,KAAd,CAAoB8B,UAA7B,GAAwC,GAAlE;AACH,iBAJD;AAKA,qBAAKxN,QAAL,CAAcyN,MAAd,CAAqB,UAASvL,GAAT,EAAa;AAC9BlB,4BAAQC,GAAR,CAAY,iBAAZ,EAA+BiB,GAA/B;AACH,iBAFD;AAGA,qBAAKlC,QAAL,CAAc0N,OAAd,CAAsB,UAASxL,GAAT,EAAa;AAC/BlB,4BAAQC,GAAR,CAAY,iBAAZ,EAA+BiB,GAA/B;AACH,iBAFD;;AAIA,uBAAO,KAAKlC,QAAZ;AACH;AACJ;AACJ,KA/7BK;;AAg8BN;;;;;;;;;;;;AAYA2N,yBA58BM,mCA48BiB;AACnB,YAAInN,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxC,gBAAG,KAAKV,OAAR,EAAgB;AACZ,uBAAO,KAAKA,OAAZ;AACH,aAFD,MAEK;AACD,qBAAKA,OAAL,GAAeoB,GAAGsM,qBAAH,CAAyB,EAAEP,UAAUpO,SAAS4O,aAArB,EAAzB,CAAf;AACA,qBAAK3N,OAAL,CAAawN,MAAb,CAAoB,UAASvL,GAAT,EAAa;AAC7BlB,4BAAQC,GAAR,CAAY,gBAAZ,EAA8BiB,GAA9B;AACH,iBAFD;AAGA,qBAAKjC,OAAL,CAAayN,OAAb,CAAqB,UAASxL,GAAT,EAAa;AAC9BlB,4BAAQC,GAAR,CAAY,gBAAZ,EAA8BiB,GAA9B;AACH,iBAFD;AAGA,uBAAO,KAAKjC,OAAZ;AACH;AACJ;AACJ,KA39BK;;AA49BL;;;;;;;;;;;;;;;;AAgBD4N,cA5+BM,sBA4+BKxN,QA5+BL,EA4+Bc;AAChB,YAAIC,OAAO,IAAX;AACA;AACAe,WAAG+K,UAAH,CAAc;AACVnK,mBADU,mBACFC,GADE,EACE;AACR;AACA,oBAAGA,IAAIoK,WAAJ,CAAgB,wBAAhB,CAAH,EAA6C;AACzChM,yBAAKwN,OAAL,CAAazN,QAAb;AACH,iBAFD,MAEK;AACD;AACAgB,uBAAG0M,SAAH,CAAa;AACTC,+BAAO,wBADE;AAET/L,+BAFS,mBAEDK,IAFC,EAEI;AACT;AACAhC,iCAAKuN,UAAL,CAAgBxN,QAAhB;AACH,yBALQ;AAMT8D,4BANS,gBAMJ7B,IANI,EAMC;AACN;AACAjB,+BAAG4M,SAAH,CAAa;AACT3K,uCAAO,IADE;AAET4K,yCAAS,YAFA;AAGTC,4CAAY,KAHH;AAITlM,uCAJS,qBAIA;AACLZ,uCAAG+M,WAAH,CAAe;AACXnM,+CADW,mBACHoM,IADG,EACE;AACT;AACA,gDAAGA,KAAK/B,WAAL,CAAiB,wBAAjB,CAAH,EAA8C;AAC1ChM,qDAAKuN,UAAL,CAAgBxN,QAAhB;AACH,6CAFD,MAEK;AACDgB,mDAAG4K,SAAH,CAAa,EAAE3I,OAAO,MAAT,EAAb;AACAjD,yDAAS,IAAT;AACH;AACJ;AATU,qCAAf;AAWH;AAhBQ,6BAAb;AAkBH;AA1BQ,qBAAb;AA4BH;AACJ,aApCS;AAqCV8D,gBArCU,kBAqCJ;AACF9D,yBAAS,IAAT;AACH;AAvCS,SAAd;AAyCH,KAxhCK;AAyhCNyN,WAzhCM,mBAyhCGzN,QAzhCH,EAyhCa;AACf,YAAGG,GAAG8N,cAAH,GAAoB,OAAvB,EAA+B;AAC3B;AACA,gBAAIC,SAAS/N,GAAG4E,IAAH,CAAQmJ,MAArB;AACA,gBAAIpD,QAAS3K,GAAGgO,OAAH,CAAWrD,KAAxB;AACA,gBAAIG,SAAU9K,GAAGgO,OAAH,CAAWlD,MAAzB;;AAEAiD,mBAAOE,cAAP,CAAsB;AAClBC,mBAAG,CADe;AAElBC,mBAAG,CAFe;AAGlBxD,uBAAOA,KAHW;AAIlBG,wBAAQA,MAJU;AAKlBsD,2BAAWzD,KALO;AAMlB0D,4BAAYvD,MANM;AAOlBrJ,uBAPkB,mBAOTC,GAPS,EAOJ;AACV;AACA;AACA;AACAb,uBAAGyN,sBAAH,CAA0B;AACtBC,kCAAU7M,IAAI8M,YADQ;AAEtB/M,+BAFsB,mBAEdK,IAFc,EAET;AACTtB,oCAAQC,GAAR,CAAY,iBAAZ,EAA8BqB,IAA9B;AACAjC,qCAAS,IAAT;AACH,yBALqB;AAMtB8D,4BANsB,gBAMjB7B,IANiB,EAMZ;AACNtB,oCAAQC,GAAR,CAAY,cAAZ,EAA2BqB,IAA3B;AACAjC,qCAAS,IAAT;AACH;AATqB,qBAA1B;AAWH;AAtBiB,aAAtB;AAwBH,SA9BD,MA8BK;AACD;AACA,gBAAI4O,aAAa,IAAIzO,GAAG4J,IAAP,CAAY,QAAZ,CAAjB;AACA6E,uBAAW5E,MAAX,GAAoB7J,GAAG8J,QAAH,CAAYC,QAAZ,GAAuBC,cAAvB,CAAsC,QAAtC,CAApB;AACA,gBAAI0E,SAASD,WAAWxE,YAAX,CAAwBjK,GAAG2O,MAA3B,CAAb;;AAGA;AACA,gBAAI5H,UAAU,IAAI/G,GAAG4O,aAAP,EAAd;AACA;AACA,gBAAIC,KAAK7O,GAAG4E,IAAH,CAAQkK,cAAjB;AACA/H,oBAAQgI,YAAR,CAAqB/O,GAAGgP,WAAH,CAAerE,KAApC,EAA2C3K,GAAGgP,WAAH,CAAelE,MAA1D,EAAkE+D,GAAGI,cAArE;AACAP,mBAAOQ,aAAP,GAAuBnI,OAAvB;AACA,iBAAKA,OAAL,GAAeA,OAAf;;AAGA,gBAAI4D,SAAQ,KAAK5D,OAAL,CAAa4D,KAAzB;AACA,gBAAIG,UAAS,KAAK/D,OAAL,CAAa+D,MAA1B;AACA,gBAAIiD,UAASoB,SAASC,aAAT,CAAuB,QAAvB,CAAb;AACA,gBAAIC,MAAMtB,QAAOuB,UAAP,CAAkB,IAAlB,CAAV;AACAvB,oBAAOpD,KAAP,GAAeA,MAAf;AACAoD,oBAAOjD,MAAP,GAAgBA,OAAhB;AACA4D,mBAAOa,MAAP;AACA,gBAAInO,OAAO,KAAK2F,OAAL,CAAayI,UAAb,EAAX;AACA,gBAAIC,WAAW9E,SAAQ,CAAvB;AACA,iBAAK,IAAI+E,MAAM,CAAf,EAAkBA,MAAM5E,OAAxB,EAAgC4E,KAAhC,EAAuC;AACnC,oBAAIC,OAAO7E,UAAS,CAAT,GAAa4E,GAAxB;AACA,oBAAIE,YAAYP,IAAIQ,eAAJ,CAAoBlF,MAApB,EAA2B,CAA3B,CAAhB;AACA,oBAAImF,QAAQH,OAAKhF,MAAL,GAAW,CAAvB;AACA,qBAAK,IAAItI,IAAI,CAAb,EAAgBA,IAAIoN,QAApB,EAA8BpN,GAA9B,EAAmC;AAC/BuN,8BAAUxO,IAAV,CAAeiB,CAAf,IAAoBjB,KAAK0O,QAAMzN,CAAX,CAApB;AACH;AACDgN,oBAAIU,YAAJ,CAAiBH,SAAjB,EAA4B,CAA5B,EAA+BF,GAA/B;AACH;AACD,gBAAIM,UAAUjC,QAAOkC,SAAP,CAAiB,YAAjB,CAAd;AACA,gBAAIzB,eAAeT,QAAOmC,kBAAP,CAA0B;AACzChC,mBAAG,CADsC;AAEzCC,mBAAG,CAFsC;AAGzCxD,uBAAOA,MAHkC;AAIzCG,wBAAQA,OAJiC;AAKzCsD,2BAAWzD,MAL8B;AAMzC0D,4BAAYvD;AAN6B,aAA1B,CAAnB;AAQA;AACAjK,eAAGyN,sBAAH,CAA0B;AACtBC,0BAAUC,YADY;AAEtB/M,uBAFsB,mBAEdK,IAFc,EAET;AACTtB,4BAAQC,GAAR,CAAY,iBAAZ,EAA8BqB,IAA9B;AACAjC,6BAAS,IAAT;AACH,iBALqB;AAMtB8D,oBANsB,gBAMjB7B,IANiB,EAMZ;AACNtB,4BAAQC,GAAR,CAAY,cAAZ,EAA2BqB,IAA3B;AACAjC,6BAAS,IAAT;AACH;AATqB,aAA1B;AAWH;AAEJ;AAjnCK,CAAV;AAqnCA;AACAsQ,OAAOzR,GAAP,GAAaA,GAAb","file":"sdk.js","sourceRoot":"..\\..\\..\\..\\assets\\Sdk","sourcesContent":["/**\r\n1.安装apidoc，参考链接：\r\n\thttp://apidocjs.com\r\n2.按照格式弄好后，执行命令\r\n    apidoc -i ./apiTest/assets/Sdk -o api/\r\n    \r\n    在小程序后台添加合法域名：\r\n        https://game.llewan.com:1899\r\n        https://login.llewan.com:1799\r\n        https://log.llewan.com:1999\r\n        https://res.llewan.com:2099\r\n\r\n        https://glog.aldwx.com\r\n */\r\n\r\nvar md5 = require(\"md5\");\r\nvar mta = require(\"mta\");\r\nvar sdk_conf = require(\"sdk_conf\");\r\nvar aldgame = require(\"ald-game\");\r\nvar sdk = { \r\n    md5: md5,\r\n    mta: mta,\r\n    ip1: \"https://login.llewan.com:1799\",\r\n    ip2: \"https://game.llewan.com:1899\",\r\n    ip3: \"https://log.llewan.com:1999\",\r\n    ip4: \"https://res.llewan.com:2099\",\r\n    loginBg: \"https://res.g.llewan.com/uploadfile/common/20180831/20180831173032_3279.png\",\r\n    loginBt: \"https://res.g.llewan.com/uploadfile/common/20180831/20180831180006_1583.png\",\r\n\r\n    debug: false,//是否开启调试\r\n\r\n    login: '/Login/common',\r\n    Config: '/Config/common',\r\n    ConfigData: { \r\n        \"config1\": {},\r\n        \"config2\": {},\r\n    },\r\n    Share: \"/Share/common\",\r\n    ShareList: [],\r\n    Logcommon: \"/Log/common\",\r\n\r\n    BannerAd: null,\r\n    VideoAd: null,\r\n\r\n    //.即将废弃，请不要操作此变量。\r\n    userid: 0,\r\n\r\n    /**\r\n     * @apiGroup A\r\n     * @apiName init\r\n     * @api {初始化sdk} 使用sdk前，必须先初始化一次才能使用 init（初始化sdk）\r\n     *\r\n     * @apiParam {Boolean} [debug=false] 是否开启调试\r\n     * @apiParam {int} [userid] 用户的id（兼容旧游戏，新游戏废弃）\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * //.初始化游戏\r\n     *   sdk.init({\r\n     *      debug: true,        //.是否开启调试\r\n     *      userid: 56032607    //.用户的id（兼容旧游戏，新游戏废弃）\r\n     *   }, (res)=>{\r\n     *       console.log('sdk初始化结果：', res)\r\n     *   })\r\n     */\r\n    init(args, callback){\r\n        var self = this;\r\n        if(args.debug){\r\n            this.debug = args.debug;\r\n        }\r\n        if(args.userid){\r\n            this.userid = args.userid;\r\n        }\r\n        \r\n        this.checkUpdate();\r\n        \r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            //1.初始化后台配置信息\r\n            this.Get(this.ip2 + this.Config, {}, function (d) {\r\n                if (d && d.c == 1) {\r\n                    self.ConfigData = d.d;\r\n\r\n                    //2.初始化分享信息\r\n                    self.Get(self.ip2 + self.Share, {}, function (d2) {\r\n                        // console.log(\"初始化分享信息：\",d2)\r\n                        if (d2 && d2.c == 1) {\r\n                            self.ShareList = d2.d;\r\n                        }else{\r\n                            console.log(\"初始化分享信息失败：\",d2)\r\n                        }\r\n                        callback(true);\r\n                    });\r\n                }else{\r\n                    if(self.debug){\r\n                        console.log(\"后台配置信息初始化失败，再次初始化：\",d)\r\n                    }\r\n                    self.init(args, callback);\r\n                }\r\n            });\r\n            \r\n            if(this.getUser()){\r\n                this.userid = this.getUser().uid;\r\n            }\r\n            if(this.userid){\r\n                //2.统计：分享信息 测试：  uid=56032607&share_id=22&share_uid=56032607\r\n                var option = wx.getLaunchOptionsSync();\r\n                // console.log(\"==option==\", option)\r\n                if(option.query.share_id && option.query.uid){\r\n                    option.query.share_uid = option.query.uid;\r\n                    option.query.uid = this.userid;\r\n                    // console.log('==3统计信息==',option)\r\n                    this.Post(this.ip3 + this.Logcommon, { log_type: \"ShareEnter\", data: JSON.stringify(option) }, function (d) {\r\n                        // console.log(\"==3统计信息结果==\", d)\r\n                    });\r\n                }\r\n                wx.onShow((option)=>{\r\n                    // console.log(option)\r\n                    if(option.query.uid){\r\n                        option.query.share_uid = option.query.uid;\r\n                        option.query.uid = self.userid;\r\n                        // console.log('==4统计信息==',option)\r\n                        self.Post(self.ip3 + self.Logcommon, { log_type: \"ShareEnter\", data: JSON.stringify(option) }, function (d) {\r\n                            // console.log(\"==4统计信息结果==\", d)\r\n                        });\r\n                    }\r\n                })\r\n\r\n                //5.统计：每次打开小游戏调用\r\n                wx.getSystemInfo({\r\n                    success(res){\r\n                        var loginData = res;\r\n                        loginData.uid = self.userid;\r\n                        loginData.share_uid = option.query.share_uid;\r\n                        loginData.scene = option.scene;\r\n                        wx.getNetworkType({\r\n                            success(res2){\r\n                                loginData.network_type = res2.networkType;\r\n                                // console.log(\"======loginData=======\", loginData)\r\n                                self.Get(self.ip3 + self.Logcommon, { log_type: \"LoginData\", data: JSON.stringify(loginData) }, function (d) {\r\n                                    // console.log(\"==5.统计：每次打开小游戏调用==\", d)\r\n                                });\r\n                            }\r\n                        })\r\n                    }\r\n                })\r\n            }\r\n\r\n        }\r\n\r\n        \r\n    },\r\n    //.根据权重随机获取指定type类型的分享信息。（没有this.ShareList数据不能调用）\r\n    getShareByWeight(type){\r\n        if(this.ShareList.length > 0){\r\n            //1.获取某种type的集合\r\n            var tArray = [];\r\n            for (var i = 0; i < this.ShareList.length; i++) {\r\n                if (type == this.ShareList[i].type) {\r\n                    this.ShareList[i].weight = parseInt(this.ShareList[i].weight);\r\n                    tArray.push(this.ShareList[i]);\r\n                }\r\n            }\r\n            //2.根据权重配比：从i集合（权重越大占比越多）中随机获取。\r\n            var iArray = [];\r\n            for (var i = 0; i < tArray.length; i++) {\r\n                for (var j = 0; j < tArray[i].weight; j++) {\r\n                    iArray.push(i);\r\n                }\r\n            }\r\n            var i = iArray[parseInt(Math.random() * iArray.length)];\r\n            //3.结果处理：正则替换昵称\r\n            var item = tArray[i];\r\n            if(item.title.indexOf(\"&nickName\") != -1){\r\n                item.title = item.title.replace(/&nickName/g, this.getUser().nickName);\r\n            }\r\n            return JSON.parse(JSON.stringify(item));\r\n        }else{\r\n            return null;\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName onShareAppMessage\r\n     * @api {分享} 注册微信右上角分享 onShareAppMessage(分享)\r\n     * @apiParam {int} type=0 后台自定义的分享类型；例如：0：右上角分享、1：普通分享 2：分享加金币\r\n     * @apiParam {String} [title] 转发标题\r\n     * @apiParam {String} [imageUrl] 转发显示图片的链接\r\n     * @apiParam {String} [query] 必须是 key1=val1&key2=val2 的格式。\r\n     * @apiParam {callback} [success] 成功回调\r\n     * @apiParam {callback} [fail] 失败回调\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.onShareAppMessage({type: 0, query: \"uid=520\" });\r\n     */\r\n    onShareAppMessage(obj){\r\n        var self = this;\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            //.微信右上角分享\r\n            wx.showShareMenu({withShareTicket:true})\r\n            wx.onShareAppMessage(function(res){\r\n                //.默认0：右上角分享\r\n                var tpye = 0;\r\n                if(obj.type){\r\n                    tpye = obj.type;\r\n                }\r\n                var shareInfo = self.getShareByWeight(tpye)\r\n\r\n                if(obj.title){\r\n                    shareInfo.title = obj.title;\r\n                }\r\n                if(obj.imageUrl){\r\n                    shareInfo.imageUrl = obj.imageUrl;\r\n                }\r\n                if(shareInfo.query){\r\n                    shareInfo.query += obj.query + \"&share_id=\"+shareInfo.sysid + \"&uid=\"+self.userid;\r\n                }else{\r\n                    if(obj.query){\r\n                        shareInfo.query = \"share_id=\"+shareInfo.sysid+\"&uid=\"+self.userid +\"&\" + obj.query;\r\n                    }else{\r\n                        shareInfo.query = \"share_id=\"+shareInfo.sysid + \"&uid=\"+self.userid;\r\n                    }\r\n                }\r\n                if(obj.success){\r\n                    shareInfo.success = obj.success;\r\n                }\r\n                if(obj.fail){\r\n                    shareInfo.fail = obj.fail;\r\n                }\r\n\r\n                //.分享统计 测试：  uid=11&share_id=22\r\n                var option = {'uid': sdk.userid, 'share_id': shareInfo.sysid };\r\n                // console.log('==1统计信息==', { log_type: \"ShareClick\", data: option })\r\n                self.Get(self.ip3 + self.Logcommon, { log_type: \"ShareClick\", data: JSON.stringify(option) }, function (d) {\r\n                    // console.log(\"==1统计信息结果==\", d)\r\n                });\r\n\r\n                return shareInfo;\r\n            })\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName shareAppMessage\r\n     * @api {分享} 主动拉起微信分享 shareAppMessage(分享)\r\n     * @apiParam {int} type=1 后台自定义的分享类型；例如：0：右上角分享、1：普通分享 2：分享加金币\r\n     * @apiParam {String} [title] 转发标题\r\n     * @apiParam {String} [imageUrl] 转发显示图片的链接\r\n     * @apiParam {String} [query] 必须是 key1=val1&key2=val2 的格式。\r\n     * @apiParam {callback} [success] 成功回调\r\n     * @apiParam {callback} [fail] 失败回调\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.shareAppMessage({type: 1, query: \"uid=520\" });\r\n     */\r\n    shareAppMessage(obj){\r\n        var self = this;\r\n        //.默认1：普通分享\r\n        var tpye = 1;\r\n        if(obj.type){\r\n            tpye = obj.type;\r\n        }\r\n        var shareInfo = this.getShareByWeight(tpye);\r\n        if(obj.title){\r\n            shareInfo.title = obj.title;\r\n        }\r\n        if(obj.imageUrl){\r\n            shareInfo.imageUrl = obj.imageUrl;\r\n        }\r\n        if(shareInfo.query){\r\n            shareInfo.query += obj.query + \"&share_id=\"+shareInfo.sysid + \"&uid=\"+self.userid;\r\n        }else{\r\n            if(obj.query){\r\n                shareInfo.query = \"share_id=\"+shareInfo.sysid+\"&uid=\"+self.userid +\"&\" + obj.query;\r\n            }else{\r\n                shareInfo.query = \"share_id=\"+shareInfo.sysid + \"&uid=\"+self.userid;\r\n            }\r\n        }\r\n        if(obj.success){\r\n            shareInfo.success = obj.success;\r\n        }\r\n        if(obj.fail){\r\n            shareInfo.fail = obj.fail;\r\n        }\r\n        console.log(\"====111======\", shareInfo);\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.shareAppMessage(shareInfo);\r\n\r\n            //.分享统计 测试： uid=11&share_id=22\r\n            var option = {'uid': sdk.userid, 'share_id': shareInfo.sysid };\r\n            // console.log('==2统计信息==', { log_type: \"ShareClick\", data: option })\r\n            self.Get(self.ip3 + self.Logcommon, { log_type: \"ShareClick\", data: JSON.stringify(option) }, function (d) {\r\n                // console.log(\"==2统计信息结果==\", d)\r\n            });\r\n        }\r\n    },\r\n\r\n\r\n    /**\r\n     * @apiIgnore\r\n     * @apiGroup B\r\n     * @apiName initmta\r\n     * @api {初始化腾讯统计sdk} 参考链接http://mta.qq.com/wechat_mini/manage/ctr_sdk_help?app_id=500625714 initmta（腾讯统计）\r\n     * @apiParam {Object} args 参数\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * //.简单\r\n     * mta.App.init({\r\n     *     \"appID\":\"500618042\",\r\n     *     \"eventID\":\"500618044\"\r\n     * });\r\n     * //.高级\r\n     * mta.App.init({\r\n     *     \"appID\":\"500618042\",\r\n     *     \"eventID\":\"500618044\", // 高级功能-自定义事件统计ID，配置开通后在初始化处填写\r\n     *     \"lauchOpts\":options, //渠道分析,需在onLaunch方法传入options,如onLaunch:function(options){...}\r\n     *     \"statPullDownFresh\":true, // 使用分析-下拉刷新次数/人数，必须先开通自定义事件，并配置了合法的eventID\r\n     *     \"statShareApp\":true, // 使用分析-分享次数/人数，必须先开通自定义事件，并配置了合法的eventID\r\n     *     \"statReachBottom\":true // 使用分析-页面触底次数/人数，必须先开通自定义事件，并配置了合法的eventID\r\n     * });\r\n     */\r\n    initmta(args){\r\n        mta.App.init(args);\r\n        // 功能组件\r\n        // App id: 500625714\r\n        // App Secret key: 9b0fd6393ca10f5eebe0d1c659a460ab\r\n    },\r\n    /**\r\n     * @apiIgnore\r\n     * @apiGroup B\r\n     * @apiName setmta\r\n     * @api {腾讯统计埋点} 统计埋点 setmta\r\n     * @apiParam {String} name 腾讯后台查询\r\n     * @apiParam {String} value 腾讯后台查询\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.setmta(\"click\",\"p003\")\r\n     */\r\n    setmta(name, value){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            mta.Event.stat(name, { value: 'true' })\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup B\r\n     * @apiName setAld\r\n     * @api {阿拉丁埋点} 统计埋点(使用前请到阿拉丁注册游戏，并配置sdk/ald-game-conf.js) setAld（阿拉丁埋点）\r\n     * @apiParam {String} type 描述用户的动作名称，不超过255个字符,不支持数字,英文,中文,\"-\"、\"_\"、\"+\",以外的字符格式\r\n     * @apiParam {String} key 动作的参数，不超过255个字符，不支持数字，英文，中文，\"-\"、\"_\"、\"+\"，以外的字符格式\r\n     * @apiParam {String} value 动作的参数值，不超过255个字符，不支持数字，英文，中文，“-“、”_”、\"+\"，以外的字符格式\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * //使用前，在开发者设置中添加 request合法域名https://glog.aldwx.com\r\n     * //统计类型（点击）， 统计位置（开始游戏按钮），  统计参数（点了1次）\r\n     * sdk.setAld(\"click\", \"playButton\", \"1\")\r\n     */\r\n    setAld(type, key, value){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            // wx.aldSendEvent('事件名称',{'参数key' : '参数value'})、\r\n            wx.aldSendEvent(v1,  { v2 : v3 })\r\n        }\r\n    },\r\n\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName Get\r\n     * @api {Get} 发起网络请求 Get（发起Get请求）\r\n     * \r\n     * @apiParam {String} url 请求地址\r\n     * @apiParam {Object} reqData 请求参数\r\n     * @apiParam {Object} callback 不存在返回null\r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.Get(\"https://xxx.xxx\", { user_id: user_id }, function (d) {\r\n     *     console.log(d)\r\n     * });\r\n     */\r\n    Get(url, reqData, callback) {\r\n        var self = this;\r\n\r\n        reqData.game = sdk_conf.game;\r\n        reqData.version = sdk_conf.version;\r\n        var ts = new Date().getTime();\r\n        reqData.ts = ts;\r\n        //数据验证签名。规则为：MD5(ts.substr(9,4)+game.substr(0,2)+version.substr(0,1)+key),时间戳后4位、data前3位、key（服务端提供）然后进行MD5加密\r\n        reqData.sign = md5(ts.toString().substr(9,4)+sdk_conf.game.substr(0,2)+sdk_conf.version.substr(0,1)+ '$5dfjr$%dsadsfdsii');\r\n        \r\n        url += \"?\";\r\n        for (var item in reqData) {\r\n            url += item + \"=\" + reqData[item] + \"&\";\r\n        }\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4) {\r\n                if (xhr.status >= 200 && xhr.status < 400) {\r\n                    var response = xhr.responseText;\r\n                    if (response) {\r\n                        var responseJson = JSON.parse(response);\r\n                        callback(responseJson);\r\n                    } else {\r\n                        if(self.debug){\r\n                            console.log(\"返回数据不存在\",url)\r\n                        }\r\n                        callback(null);\r\n                    }\r\n                } else {\r\n                    if(self.debug){\r\n                        console.log(\"请求失败\",url)\r\n                    }\r\n                    callback(null);\r\n                }\r\n            }\r\n        };\r\n        xhr.open(\"GET\", url, true);\r\n        xhr.send();\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName Post\r\n     * @api {Post} 发起网络请求 Post（发起Post请求）\r\n     * \r\n     * @apiParam {String} url 请求地址\r\n     * @apiParam {Object} reqData 请求参数\r\n     * @apiParam {Object} callback 不存在返回null\r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.Post(sdk.ip + sdk.common, { user_id: user_id }, function (d) {\r\n     *     console.log(d)\r\n     * });\r\n     */\r\n    Post: function (url, reqData, callback) {\r\n        var self = this;\r\n        \r\n        reqData.game = sdk_conf.game;\r\n        reqData.version = sdk_conf.version;\r\n        var ts = new Date().getTime();\r\n        reqData.ts = ts;\r\n        reqData.sign = md5(ts.toString().substr(9,4)+sdk_conf.game.substr(0,2)+sdk_conf.version.substr(0,1)+ '$5dfjr$%dsadsfdsii');\r\n        \r\n        //1.拼接请求参数\r\n        var param = \"\";\r\n        for (var item in reqData) {\r\n            param += item + \"=\" + reqData[item] + \"&\";\r\n        }\r\n        //2.发起请求\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4) {\r\n                if (xhr.status >= 200 && xhr.status < 400) {\r\n                    var response = xhr.responseText;\r\n                    // console.log(response)\r\n                    if (response) {\r\n                        var responseJson = JSON.parse(response);\r\n                        callback(responseJson);\r\n                    } else {\r\n                        if(self.debug){\r\n                            console.log(\"返回数据不存在\")\r\n                        }\r\n                        callback(null);\r\n                    }\r\n                } else {\r\n                    if(self.debug){\r\n                        console.log(\"请求失败\",xhr)\r\n                    }\r\n                    callback(null);\r\n                }\r\n            }\r\n        };\r\n        xhr.open(\"POST\", url, true);\r\n        xhr.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\n        xhr.send(param);//reqData为字符串形式： \"key=value\"\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName checkUpdate\r\n     * @api {检测版本更新} 微信小游戏（冷启动的时候会检查，如果有更新则会重启小游戏进行更新） checkUpdate（版本更新）\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.checkUpdate();\r\n     */\r\n    checkUpdate() {\r\n        var self = this;\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME && typeof wx.getUpdateManager === 'function') {\r\n            const updateManager = wx.getUpdateManager()\r\n            updateManager.onCheckForUpdate(function (res) {\r\n                if(self.debug){\r\n                    console.log(\"请求完新版本信息的回调\", res.hasUpdate)\r\n                }\r\n            })\r\n            updateManager.onUpdateReady(function () {\r\n                if(self.debug){\r\n                    console.log(\"新的版本已经下载好，调用 applyUpdate 应用新版本并重启\")\r\n                }\r\n                updateManager.applyUpdate()\r\n            })\r\n            updateManager.onUpdateFailed(function () {\r\n                if(self.debug){\r\n                    console.log(\"新的版本下载失败\")\r\n                }\r\n            })\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName getConfig1\r\n     * @api {运营配置} 游戏后台配置信息，运营人员使用的通用配置开关 getConfig1（运营配置）\r\n     * @apiParam {Object} callback 不存在返回null\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * var d = sdk.getConfig1();\r\n     */\r\n    getConfig1(){\r\n        return JSON.parse(this.ConfigData.config1);\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName getConfig2\r\n     * @api {程序配置} 游戏后台配置信息，程序员使用的游戏数据开关，可随便自定义数据：例如复活次数等 getConfig2（程序配置）\r\n     * @apiParam {Object} callback 不存在返回null\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * var d = sdk.getConfig2();\r\n     */\r\n    getConfig2(){\r\n        return JSON.parse(this.ConfigData.config2);\r\n    },\r\n\r\n    \r\n    /**\r\n     * @apiGroup C\r\n     * @apiName createImage\r\n     * @api {显示网络图片} 微信小游戏加载图片 createImage（显示图片）\r\n     * @apiParam {cc.Sprite} sprite 显示图片的Sprite\r\n     * @apiParam {String} url 需要加载的图片地址\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * var data = sdk.createImage(advs);\r\n     */\r\n    createImage(sprite, url) {\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            let image = wx.createImage();\r\n            image.onload = function () {\r\n                let texture = new cc.Texture2D();\r\n                texture.initWithElement(image);\r\n                texture.handleLoadedTexture();\r\n                sprite.spriteFrame = new cc.SpriteFrame(texture);\r\n            };\r\n            image.src = url;\r\n        }\r\n        \r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName getUser\r\n     * @api {获取本地用户信息} 获取本地用户信息（登录成功后，会在本地存储用户信息） getUser（获取用户信息）\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * //.不存在返回null\r\n     * var user = sdk.getUser();\r\n     */\r\n    getUser(){\r\n        var userinfo = this.getItem('userinfo');\r\n        if(userinfo){\r\n            return JSON.parse(userinfo);\r\n        }else{\r\n            return null;\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName setItem\r\n     * @api {set} 数据存储 setItem（存）\r\n     * @apiParam {String} key 键\r\n     * @apiParam {String} value 值\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.setItem(\"nick\",\"hello\")\r\n     */\r\n    setItem(key, value){\r\n        cc.sys.localStorage.setItem(key, value);\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName getItem\r\n     * @api {数据存储} 数据存储 getItem（取）\r\n     * @apiParam {String} key 键\r\n     * @apiParam {String} value 值\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * var nick = sdk.getItem(\"nick\")\r\n     */\r\n    getItem(key){\r\n        return cc.sys.localStorage.getItem(key);\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName onMessage\r\n     * @api {主域监听子域发送的消息} 主域监听子域发送的消息 onMessage（监听消息）\r\n     * @apiParam {callback} callback 回调函数\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.onMessage((d)=>{\r\n     *     console.log(d)\r\n     * })\r\n     */\r\n    onMessage(callback){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.onMessage(function(d){\r\n                // if(d.message == \"common_back\"){//.子域: 返回子域首页\r\n                //     cc.director.loadScene(\"common_children\")\r\n                // }\r\n                callback(d)\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName postMessage\r\n     * @api {主域向子域发送消息} 主域向子域发送消息 postMessage（发送消息）\r\n     * @apiParam {String} msg 发送给子域的消息\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.postMessage(\"hello\")\r\n     */\r\n    postMessage(msg){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.postMessage({ message: msg });\r\n        }\r\n    },\r\n    //.主域上报数据:    对用户托管数据进行写数据操作，允许同时写多组 KV 数据。\r\n    setUserCloudStorage(kvDataList, callback){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.setUserCloudStorage({\r\n                KVDataList: kvDataList,\r\n                success(res){\r\n                    callback(res)\r\n                },\r\n                fail(res){\r\n                    callback(res)\r\n                }\r\n            })\r\n        }\r\n    },\r\n    //.获取当前用户托管数据当中对应 key 的数据。该接口只可在开放数据域下使用\r\n    getUserCloudStorage(keyList, callback){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.getUserCloudStorage({\r\n                keyList: keyList,\r\n                success(res){\r\n                    callback(res)\r\n                },\r\n                fail(res){\r\n                    callback(res)\r\n                }\r\n            })\r\n        }\r\n    },\r\n    //.在小游戏是通过群分享卡片打开的情况下，可以通过调用该接口获取群同玩成员的游戏数据。该接口只可在开放数据域下使用。\r\n    getGroupCloudStorage(shareTicket, keyList, callback){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.getGroupCloudStorage({\r\n                shareTicket: shareTicket,\r\n                keyList: keyList,\r\n                success(res){\r\n                    callback(res)\r\n                },\r\n                fail(res){\r\n                    callback(res)\r\n                }\r\n            })\r\n        }\r\n    },\r\n    //.拉取当前用户所有同玩好友的托管数据。该接口只可在开放数据域下使用\r\n    getFriendCloudStorage(keyList, callback){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.getFriendCloudStorage({\r\n                keyList: keyList,\r\n                success(res){\r\n                    callback(res)\r\n                },\r\n                fail(res){\r\n                    callback(res)\r\n                }\r\n            })\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName sortList\r\n     * @api {对子域数据进行排序} 对子域数据进行排序 sortList（子域排序）\r\n     * @apiParam {String} ListData 要排序的微信子域数据\r\n     * @apiParam {String} field 排序字段\r\n     * @apiParam {String} order 正序：true  ； 倒序：false\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * wx.getFriendCloudStorage({\r\n     *       keyList: [\"score\"],\r\n     *       success(res){\r\n     *           var ListData = sdk.sortList(res.data, 'score', true));\r\n     *           console.log(\"=排序后的数据=\", ListData);\r\n     *       },\r\n     *       fail(){\r\n     *           console.log(res)\r\n     *       }\r\n     *})\r\n     */\r\n    sortList(ListData, field, order){\r\n        ListData.sort(function(a,b){\r\n            var AMaxScore = 0;\r\n            var KVDataList = a.KVDataList;\r\n            for(var i=0; i<KVDataList.length; i++){\r\n                if(KVDataList[i].key == field){\r\n                    AMaxScore = KVDataList[i].value;\r\n                }\r\n            }\r\n\r\n            var BMaxScore = 0;\r\n            KVDataList = b.KVDataList;\r\n            for(var i=0; i<KVDataList.length; i++){\r\n                if(KVDataList[i].key == field){\r\n                    BMaxScore = KVDataList[i].value;\r\n                }\r\n            }\r\n\r\n            if(order){\r\n                return parseInt(AMaxScore) - parseInt(BMaxScore);\r\n            }else{\r\n                return parseInt(BMaxScore) - parseInt(AMaxScore);\r\n            }\r\n        });\r\n        return ListData;\r\n    },\r\n    /**\r\n     * @apiIgnore\r\n     * @apiGroup C\r\n     * @apiName getMyRank3\r\n     * @api {排名与我相邻的3位玩家信息} 排名与我相邻的3位玩家信息 getMyRank3（Top3）\r\n     * @apiParam {String} ListData 要排序的微信子域数据\r\n     * @apiParam {String} me 我的子域信息\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * wx.getUserInfo({\r\n     *       openIdList: ['selfOpenId'],\r\n     *       lang: 'zh_CN',\r\n     *       success(res){\r\n     *          //.Top3\r\n     *          var dList = sdk.getMyRank3(dataList,res.data[0]);\r\n     *          console.log(dList)\r\n     *       },\r\n     *       fail(error) {\r\n     *          console.log(error)\r\n     *       }\r\n     * })\r\n     * \r\n     * \r\n     */\r\n    getMyRank3(ListData,me){\r\n        var dataList = [];\r\n        for(var i=0; i<ListData.length; i++){\r\n            if(ListData.length <= 3){\r\n                //.只有3个人或以下\r\n                if(ListData[i].avatarUrl == me.avatarUrl && ListData[i].nickname == me.nickName){\r\n                    ListData[i].isSelf = true;//.标记自己\r\n                }\r\n                dataList = ListData;\r\n                for(var i=0; i<dataList.length; i++){\r\n                    dataList[i].rank = i;\r\n                }                 \r\n            }else{\r\n                if(ListData[i].avatarUrl == me.avatarUrl && ListData[i].nickname == me.nickName){\r\n                    ListData[i].isSelf = true;//.标记自己\r\n                    if(i == ListData.length-1){\r\n                        //.自己分数最低\r\n                        ListData[i].rank = i;\r\n                        ListData[i-1].rank = i-1;\r\n                        ListData[i-2].rank = i-2;\r\n                        dataList.push(ListData[i-2])\r\n                        dataList.push(ListData[i-1])\r\n                        dataList.push(ListData[i])\r\n                    }else if(i==0){\r\n                        //.自己分数最高\r\n                        ListData[i].rank = i;\r\n                        ListData[i+1].rank = i+1;\r\n                        ListData[i+2].rank = i+2;\r\n                        dataList.push(ListData[i])\r\n                        dataList.push(ListData[i+1])\r\n                        dataList.push(ListData[i+2])\r\n                    }else{\r\n                        //.居中\r\n                        ListData[i-1].rank = i-1;\r\n                        ListData[i].rank = i;\r\n                        ListData[i+1].rank = i+1;\r\n                        dataList.push(ListData[i-1])\r\n                        dataList.push(ListData[i])\r\n                        dataList.push(ListData[i+1])\r\n                    }\r\n                    break;        \r\n                }\r\n            }\r\n               \r\n        }\r\n        return dataList;\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName WeChatLogin\r\n     * @api {微信登录} 微信登录 WeChatLogin（登录）\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * // 2.登录页：获取用户信息\r\n     *   var user = sdk.getUser();\r\n     *   if(user){\r\n     *       console.log(\"用户信息：\", user)\r\n     *   }else{\r\n     *       //.调用sdk登录\r\n     *       sdk.WeChatLogin((d)=>{\r\n     *           console.log(\"用户信息：\", d)\r\n     *           // 登录成功：返回用户信息； \r\n     *           // 登录失败：返回false\r\n     *       });\r\n     *   }\r\n     * \r\n     */\r\n    WeChatLogin(callback){\r\n        var self = this;\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            var options = wx.getLaunchOptionsSync();\r\n            \r\n            var referee_id = options.query.uid;             //.推荐人id\r\n            var source_id = options.query.source_id;        //.用户来源id\r\n            var source_id2 = options.query.source_id2;      //.用户来源子id\r\n            var share_id = options.query.share_id;          //.分享素材ID\r\n            \r\n            var userinfo = this.getUser();\r\n\r\n            if(userinfo){\r\n                callback(userinfo)\r\n            }else{\r\n                //.登录遮罩背景\r\n                var maskNode = new cc.Node('Sprite');\r\n                maskNode.parent = cc.director.getScene().getChildByName('Canvas');\r\n                maskNode.addComponent(cc.BlockInputEvents)\r\n                var sp = maskNode.addComponent(cc.Sprite);\r\n                maskNode.opacity = 178;\r\n                maskNode.color = new cc.Color(25,88,95,255);\r\n                sp.sizeMode = cc.Sprite.SizeMode.CUSTOM;\r\n                self.createImage(sp, self.loginBg);\r\n                maskNode.width = cc.view.getVisibleSize().width;\r\n                maskNode.height = cc.view.getVisibleSize().height;\r\n                // console.log(maskNode.width, maskNode.height)\r\n\r\n                //.微信登录按钮\r\n                if(self.button){\r\n                    self.button.show();\r\n                }else{\r\n                    wx.getSystemInfo({\r\n                        success(res){\r\n                            var width = 507/2;\r\n                            var height = 464/2;\r\n                            self.button = wx.createUserInfoButton({\r\n                                type: 'image',\r\n                                image: self.loginBt,\r\n                                style: {  width: width, height: height, left: res.screenWidth/2-width/2, top: res.screenHeight/2-height/2 }\r\n                            })\r\n                            self.button.onTap((res1) => {\r\n                                // 处理用户拒绝授权的情况\r\n                                // if (res1.errMsg.indexOf('auth deny') > -1 || res1.errMsg.indexOf('auth denied') > -1 ) {\r\n                                //     wx.showToast();\r\n                                // }\r\n                                wx.showToast({title: '登录中...',icon:'loading',duration: 8});\r\n                                wx.getSetting({\r\n                                    success(auths){\r\n                                        if(auths.authSetting[\"scope.userInfo\"]){\r\n                                            console.log('===已经授权===');\r\n                                            wx.login({\r\n                                                success(res2){ \r\n                                                    var reqData = {   \r\n                                                        code: res2.code,\r\n                                                        rawData: res1.rawData,\r\n                                                        iv: res1.iv,\r\n                                                        encryptedData: res1.encryptedData,\r\n                                                        signature: res1.signature,\r\n\r\n                                                        referee_id: referee_id,\r\n                                                        source_id: source_id,\r\n                                                        source_id2: source_id2,\r\n                                                        share_id: share_id\r\n                                                    }\r\n                                                    // console.log('==登录参数==', reqData)\r\n                                                    self.Post(self.ip1 + self.login, reqData, function(data){\r\n                                                        // console.log('==登录结果==', data)\r\n                                                        if(data.c == 1){\r\n                                                            self.setItem('userinfo', JSON.stringify(data.d));\r\n                                                            wx.hideToast();\r\n                                                            maskNode.destroy();\r\n                                                            self.button.hide();\r\n                                                            //.登录成功，重新初始化\r\n                                                            self.userid = data.d.uid;\r\n                                                            self.init({},(d)=>{})\r\n\r\n                                                            callback(data.d);\r\n                                                        }else{\r\n                                                            // console.log('==登录接口请求失败==', data)\r\n                                                            wx.showToast({title: '登录失败请重试'});\r\n                                                        }                \r\n                                                    });\r\n                                                },\r\n                                                fail(){\r\n                                                    wx.showToast({title: '登录失败请重试'});\r\n                                                    callback(false)\r\n                                                },\r\n                                            })\r\n                                        }else{\r\n                                            callback(false)\r\n                                        }\r\n                                    }\r\n                                })        \r\n                            })\r\n                            self.button.show()\r\n                        }\r\n                    })\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName createBannerAd\r\n     * @api {微信登录} 创建banner广告组件 createBannerAd（广告）\r\n     * @apiParam {String} adUnitId 广告单元id\t\r\n     * @apiParam {String} style banner 广告组件的样式\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     *  //.参考文档：https://developers.weixin.qq.com/minigame/dev/document/ad/wx.createBannerAd.html\r\n     *  //var bannerAd = sdk.createBannerAd({\r\n     *  //    style:{\r\n     *  //        left: 0,\r\n     *  //        top: 0,\r\n     *  //        width: 100,\r\n     *  //        height: 200\r\n     *  //    }\r\n     *  //});\r\n     * \r\n     *  //.极简版（默认底部Banner）\r\n     *  var bannerAd = sdk.createBannerAd({});\r\n     *  bannerAd.show()\r\n     * \r\n     */\r\n    createBannerAd(obj){\r\n        var self = this;\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            if(this.BannerAd){\r\n                return this.BannerAd;\r\n            }else{\r\n                if(!obj.style){\r\n                    obj.style = {};\r\n                    var phone = wx.getSystemInfoSync();\r\n                    this.w = phone.screenWidth / 2;\r\n                    this.h = phone.screenHeight;\r\n                    obj.style.left = 0;\r\n                    obj.style.top = 0;\r\n                    obj.style.width = 300;\r\n                }\r\n                this.BannerAd = wx.createBannerAd({\r\n                    adUnitId: sdk_conf.bannerAdUnitId,\r\n                    style: obj.style,\r\n                })\r\n                this.BannerAd.onResize(function(res){\r\n                    console.log(\"BannerAd广告缩放事件：\", res)\r\n                    self.BannerAd.style.left = self.w - self.BannerAd.style.realWidth/2+0.1;\r\n                    self.BannerAd.style.top = self.h - self.BannerAd.style.realHeight+0.1;\r\n                });\r\n                this.BannerAd.onLoad(function(res){\r\n                    console.log(\"BannerAd广告加载事件：\", res)\r\n                });\r\n                this.BannerAd.onError(function(res){\r\n                    console.log(\"BannerAd广告错误事件：\", res)\r\n                });\r\n\r\n                return this.BannerAd;\r\n            }\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName createRewardedVideoAd\r\n     * @api {微信登录} 创建banner广告组件 createRewardedVideoAd（广告）\r\n     * @apiParam {String} adUnitId 广告单元id\t\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * //.参考文档：https://developers.weixin.qq.com/minigame/dev/document/ad/wx.createRewardedVideoAd.html\r\n     *  var videoAd = sdk.createRewardedVideoAd();\r\n     *  videoAd.load().then(() => videoAd.show());\r\n     * \r\n     */\r\n    createRewardedVideoAd(){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            if(this.VideoAd){\r\n                return this.VideoAd;\r\n            }else{\r\n                this.VideoAd = wx.createRewardedVideoAd({ adUnitId: sdk_conf.videoAdUnitId })\r\n                this.VideoAd.onLoad(function(res){\r\n                    console.log(\"VideoAd广告加载事件：\", res)\r\n                });\r\n                this.VideoAd.onError(function(res){\r\n                    console.log(\"VideoAd广告错误事件：\", res)\r\n                });\r\n                return this.VideoAd;\r\n            }\r\n        }\r\n    },\r\n     /**\r\n     * @apiGroup C\r\n     * @apiName Screenshot\r\n     * @api {微信小游戏截图保存} 微信小游戏截图保存 Screenshot（截图）\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     *   //.摄像机组件、回调\r\n     *   sdk.Screenshot((d)=>{\r\n     *       if(d){\r\n     *           console.log(\"图片保存成功：\", d)\r\n     *       }else{\r\n     *           console.log(\"图片保存失败：\", d)\r\n     *       }\r\n     *   })\r\n     * \r\n     */\r\n    Screenshot(callback){\r\n        var self = this;\r\n        //1.判断是否授权\r\n        wx.getSetting({\r\n            success(res){\r\n                // console.log(\"授权状态\", res.authSetting['scope.writePhotosAlbum'])\r\n                if(res.authSetting['scope.writePhotosAlbum']){\r\n                    self.capture(callback);\r\n                }else{\r\n                    // console.log(\"未授权\", res)\r\n                    wx.authorize({\r\n                        scope: 'scope.writePhotosAlbum',\r\n                        success(res2){\r\n                            // console.log(\"success res2\",res2)\r\n                            self.Screenshot(callback);\r\n                        },\r\n                        fail(res2){\r\n                            // console.log(\"重新授权\")\r\n                            wx.showModal({\r\n                                title: '提示',\r\n                                content: '请开启保存到相册功能',\r\n                                showCancel: false,\r\n                                success(){\r\n                                    wx.openSetting({\r\n                                        success(res3){\r\n                                            // console.log(\"===重新授权===\", res3)\r\n                                            if(res3.authSetting['scope.writePhotosAlbum']){\r\n                                                self.Screenshot(callback);\r\n                                            }else{\r\n                                                wx.showToast({ title: \"授权失败\" })\r\n                                                callback(null)\r\n                                            }\r\n                                        }\r\n                                    })\r\n                                }\r\n                            })\r\n                        }\r\n                    })\r\n                }\r\n            },\r\n            fail(){\r\n                callback(null)\r\n            }\r\n        })\r\n    },\r\n    capture (callback) {\r\n        if(cc.ENGINE_VERSION < \"2.0.0\"){\r\n            //1.9.3旧版本截图\r\n            var canvas = cc.game.canvas;\r\n            var width  = cc.winSize.width;\r\n            var height  = cc.winSize.height;\r\n\r\n            canvas.toTempFilePath({\r\n                x: 0,\r\n                y: 0,\r\n                width: width,\r\n                height: height,\r\n                destWidth: width,\r\n                destHeight: height,\r\n                success (res) {\r\n                    //.可以保存该截屏图片\r\n                    // console.log(res)\r\n                    //.保存到手机\r\n                    wx.saveImageToPhotosAlbum({\r\n                        filePath: res.tempFilePath,\r\n                        success(res2){\r\n                            console.log('==截图保存=success=',res2)\r\n                            callback(true)\r\n                        },\r\n                        fail(res2){\r\n                            console.log('==截图保存=fail=',res2)\r\n                            callback(null)\r\n                        }\r\n                    })\r\n                }\r\n            })\r\n        }else{\r\n            //2.0.1新版本截图\r\n            var cameraNode = new cc.Node('camera');\r\n            cameraNode.parent = cc.director.getScene().getChildByName('Canvas');\r\n            var camera = cameraNode.addComponent(cc.Camera);\r\n\r\n\r\n            //.要截取的范围（全屏）\r\n            let texture = new cc.RenderTexture();\r\n            // 如果截图内容中不包含 Mask 组件，可以不用传递第三个参数\r\n            let gl = cc.game._renderContext;\r\n            texture.initWithSize(cc.visibleRect.width, cc.visibleRect.height, gl.STENCIL_INDEX8);\r\n            camera.targetTexture = texture;\r\n            this.texture = texture;\r\n\r\n\r\n            let width = this.texture.width;\r\n            let height = this.texture.height;\r\n            let canvas = document.createElement('canvas');\r\n            let ctx = canvas.getContext('2d');\r\n            canvas.width = width;\r\n            canvas.height = height;\r\n            camera.render();\r\n            let data = this.texture.readPixels();\r\n            let rowBytes = width * 4;\r\n            for (let row = 0; row < height; row++) {\r\n                let srow = height - 1 - row;\r\n                let imageData = ctx.createImageData(width, 1);\r\n                let start = srow*width*4;\r\n                for (let i = 0; i < rowBytes; i++) {\r\n                    imageData.data[i] = data[start+i];\r\n                }\r\n                ctx.putImageData(imageData, 0, row);\r\n            }\r\n            var dataURL = canvas.toDataURL(\"image/jpeg\");\r\n            var tempFilePath = canvas.toTempFilePathSync({\r\n                x: 0,\r\n                y: 0,\r\n                width: width,\r\n                height: height,\r\n                destWidth: width,\r\n                destHeight: height,\r\n            });\r\n            //.保存到手机\r\n            wx.saveImageToPhotosAlbum({\r\n                filePath: tempFilePath,\r\n                success(res2){\r\n                    console.log('==截图保存=success=',res2)\r\n                    callback(true)\r\n                },\r\n                fail(res2){\r\n                    console.log('==截图保存=fail=',res2)\r\n                    callback(null)\r\n                }\r\n            })\r\n        }\r\n        \r\n    }\r\n    \r\n\r\n};\r\n// module.exports = sdk;\r\nwindow.sdk = sdk;\r\n\r\n"]}