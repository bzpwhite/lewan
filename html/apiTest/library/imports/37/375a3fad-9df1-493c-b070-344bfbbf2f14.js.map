{"version":3,"sources":["..\\..\\..\\..\\assets\\Sdk/assets\\Sdk\\sdk.js"],"names":["md5","require","mta","aldgame","sdk","ip1","ip2","debug","game","version","login","Config","ConfigData","Share","ShareList","init","args","callback","self","checkUpdate","Get","d","c","console","log","initShare","getShareByWeight","type","length","info","tArray","i","share_list","position","weight","parseInt","push","iArray","j","rI","Math","random","title","imageUrl","image","indexOf","replace","getUser","nickname","shareAppMessage","onShareAppMessage","cc","sys","platform","WECHAT_GAME","wx","showShareMenu","withShareTicket","res","shareItem","query","success","fail","initmta","App","setmta","name","value","Event","stat","setAld","key","aldSendEvent","v1","v2","v3","url","reqData","item","xhr","XMLHttpRequest","onreadystatechange","readyState","status","response","responseText","responseJson","JSON","parse","open","send","Post","param","setRequestHeader","getUpdateManager","updateManager","onCheckForUpdate","hasUpdate","onUpdateReady","applyUpdate","onUpdateFailed","getConfig1","config1","getConfig2","config2","createImage","sprite","onload","texture","Texture2D","initWithElement","handleLoadedTexture","spriteFrame","SpriteFrame","src","userinfo","getItem","setItem","localStorage","onMessage","postMessage","msg","message","setUserCloudStorage","kvDataList","KVDataList","getUserCloudStorage","keyList","getGroupCloudStorage","shareTicket","getFriendCloudStorage","sortList","ListData","field","order","sort","a","b","AMaxScore","BMaxScore","getMyRank3","me","dataList","avatarUrl","nickName","isSelf","rank","WeChatLogin","obj","loginImg","imgWidth","imgHeight","referee_id","source_id","source_id2","button","show","getSystemInfo","createUserInfoButton","style","left","screenWidth","top","screenHeight","width","height","onTap","res1","showToast","icon","duration","getSetting","auths","authSetting","res2","code","rawData","iv","encryptedData","signature","data","hideToast","hide","window"],"mappings":";;;;;;AAAA;;;;;;;;;AASA,IAAIA,MAAMC,QAAQ,KAAR,CAAV;AACA,IAAIC,MAAMD,QAAQ,KAAR,CAAV;AACA,IAAIE,UAAUF,QAAQ,UAAR,CAAd;AACA,IAAIG,MAAM;AACNJ,SAAKA,GADC;AAENE,SAAKA,GAFC;AAGN;AACAG,SAAK,uGAJC;AAKNC,SAAK,yBALC;;AAONC,WAAO,KAPD,EAOmC;AACzCC,UAAM,EARA;AASNC,aAAS,EATH;;AAWNC,WAAO,eAXD;AAYNC,YAAQ,gBAZF;AAaNC,gBAAY;AACR,mBAAW,EADH;AAER,mBAAW;AAFH,KAbN;AAiBNC,WAAO,eAjBD;AAkBNC,eAAW,EAlBL;;AAoBN;;;;;;;;;;;;;;;;;;;AAmBAC,QAvCM,gBAuCDC,IAvCC,EAuCKC,QAvCL,EAuCc;AAChB,YAAIC,OAAO,IAAX;AACA,YAAGF,KAAKT,KAAR,EAAc;AACV,iBAAKA,KAAL,GAAaS,KAAKT,KAAlB;AACH;AACD,YAAGS,KAAKR,IAAR,EAAa;AACT,iBAAKA,IAAL,GAAYQ,KAAKR,IAAjB;AACH;AACD,YAAGQ,KAAKP,OAAR,EAAgB;AACZ,iBAAKA,OAAL,GAAeO,KAAKP,OAApB;AACH;AACD,aAAKU,WAAL;;AAEA;AACA,aAAKC,GAAL,CAAS,KAAKd,GAAL,GAAW,KAAKK,MAAzB,EAAiC,EAAjC,EAAqC,UAAUU,CAAV,EAAa;AAC9C,gBAAIA,KAAKA,EAAEC,CAAF,IAAO,CAAhB,EAAmB;AACfJ,qBAAKN,UAAL,GAAkBS,EAAEA,CAApB;AACAJ,yBAAS,IAAT;AACH,aAHD,MAGK;AACD,oBAAGC,KAAKX,KAAR,EAAc;AACVgB,4BAAQC,GAAR,CAAY,eAAZ,EAA4BH,CAA5B;AACH;AACDH,qBAAKH,IAAL,CAAUC,IAAV,EAAgBC,QAAhB;AACH;AACJ,SAVD;;AAYA;AACA,aAAKQ,SAAL;AAEH,KApEK;AAqENA,aArEM,uBAqEK;AACP,YAAIP,OAAO,IAAX;AACA;AACA,aAAKE,GAAL,CAAS,KAAKd,GAAL,GAAW,KAAKO,KAAzB,EAAgC,EAAhC,EAAoC,UAAUQ,CAAV,EAAa;AAC7C,gBAAIA,KAAKA,EAAEC,CAAF,IAAO,CAAhB,EAAmB;AACfJ,qBAAKJ,SAAL,GAAiBO,EAAEA,CAAnB;AACH,aAFD,MAEK;AACDE,wBAAQC,GAAR,CAAY,aAAZ,EAA0BH,CAA1B;AACH;AACJ,SAND;AAOH,KA/EK;AAgFNK,oBAhFM,4BAgFWC,IAhFX,EAgFgB;AAClB,YAAG,KAAKb,SAAL,CAAec,MAAf,GAAwB,CAA3B,EAA6B;AACzB,gBAAIC,OAAO,EAAX;AACA,gBAAIC,SAAS,EAAb;AACA,iBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIC,WAAWJ,MAA/B,EAAuCG,GAAvC,EAA4C;AACxC,oBAAIJ,QAAQK,WAAWD,CAAX,EAAcE,QAA1B,EAAoC;AAChCD,+BAAWD,CAAX,EAAcG,MAAd,GAAuBC,SAASH,WAAWD,CAAX,EAAcG,MAAvB,CAAvB;AACAJ,2BAAOM,IAAP,CAAYJ,WAAWD,CAAX,CAAZ;AACH;AACJ;AACD,gBAAIM,SAAS,EAAb;AACA,iBAAK,IAAIN,IAAI,CAAb,EAAgBA,IAAID,OAAOF,MAA3B,EAAmCG,GAAnC,EAAwC;AACpC,qBAAK,IAAIO,IAAI,CAAb,EAAgBA,IAAIR,OAAOC,CAAP,EAAUG,MAA9B,EAAsCI,GAAtC,EAA2C;AACvCD,2BAAOD,IAAP,CAAYL,CAAZ;AACH;AACJ;AACD,gBAAIQ,KAAKF,OAAOF,SAASK,KAAKC,MAAL,KAAgBJ,OAAOT,MAAhC,CAAP,CAAT;AACA,gBAAGE,OAAOS,EAAP,CAAH,EAAc;AACVV,qBAAKa,KAAL,GAAaZ,OAAOS,EAAP,EAAWG,KAAxB;AACAb,qBAAKc,QAAL,GAAgBb,OAAOS,EAAP,EAAWK,KAA3B;AACH,aAHD,MAGK;AACDf,qBAAKa,KAAL,GAAa,MAAb;AACAb,qBAAKc,QAAL,GAAgB,EAAhB;AACH;AACD;AACA,gBAAGd,KAAKa,KAAL,CAAWG,OAAX,CAAmB,OAAnB,KAA+B,CAAC,CAAnC,EAAqC;AACjChB,qBAAKa,KAAL,GAAab,KAAKa,KAAL,CAAWI,OAAX,CAAmB,QAAnB,EAA6B,KAAKC,OAAL,GAAeC,QAA5C,CAAb;AACH;AACD,mBAAOnB,IAAP;AACH,SA5BD,MA4BK;AACD,iBAAKJ,SAAL;AACA,mBAAO,IAAP;AACH;AACJ,KAjHK;;AAkHN;;;;;;;;;AASAwB,mBA3HM,2BA2HUtB,IA3HV,EA2He,CAEpB,CA7HK;AA8HNuB,qBA9HM,6BA8HYvB,IA9HZ,EA8HiB;AACnB,YAAIwB,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxC;AACAC,eAAGC,aAAH,CAAiB,EAACC,iBAAgB,IAAjB,EAAjB;AACAF,eAAGL,iBAAH,CAAqB,UAASQ,GAAT,EAAa;AAC9B,oBAAIC,YAAYzC,KAAKQ,gBAAL,EAAhB;AACA,uBAAO;AACHgB,2BAAOiB,UAAUjB,KADd;AAEHC,8BAAUgB,UAAUhB,QAFjB;AAGHiB,2BAAOD,UAAUC,KAHd;AAIHC,2BAJG,mBAIKH,GAJL,EAIS;AACRnC,gCAAQC,GAAR,CAAYkC,GAAZ;AACH,qBANE;AAOHI,wBAPG,gBAOEJ,GAPF,EAOM;AACLnC,gCAAQC,GAAR,CAAYkC,GAAZ;AACH;AATE,iBAAP;AAWH,aAbD;AAcH;AACJ,KAjJK;;;AAqJN;;;;;;;;;;;;;;;;;;;;;;;AAuBAK,WA5KM,mBA4KE/C,IA5KF,EA4KO;AACTd,YAAI8D,GAAJ,CAAQjD,IAAR,CAAaC,IAAb;AACA;AACA;AACA;AACH,KAjLK;;AAkLN;;;;;;;;;;;AAWAiD,UA7LM,kBA6LCC,IA7LD,EA6LOC,KA7LP,EA6La;AACf,YAAIhB,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxCpD,gBAAIkE,KAAJ,CAAUC,IAAV,CAAeH,IAAf,EAAqB,EAAEC,OAAO,MAAT,EAArB;AACH;AACJ,KAjMK;;AAkMN;;;;;;;;;;;;;AAaAG,UA/MM,kBA+MC3C,IA/MD,EA+MO4C,GA/MP,EA+MYJ,KA/MZ,EA+MkB;AACpB,YAAIhB,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxC;AACAC,eAAGiB,YAAH,CAAgBC,EAAhB,EAAqB,EAAEC,IAAKC,EAAP,EAArB;AACH;AACJ,KApNK;;;AAuNN;;;;;;;;;;;;;AAaAvD,OApOM,eAoOFwD,GApOE,EAoOGC,OApOH,EAoOY5D,QApOZ,EAoOsB;AACxB,YAAIC,OAAO,IAAX;;AAEA2D,gBAAQrE,IAAR,GAAe,KAAKA,IAApB;AACAqE,gBAAQpE,OAAR,GAAkB,KAAKA,OAAvB;AACAmE,eAAO,GAAP;AACA,aAAK,IAAIE,IAAT,IAAiBD,OAAjB,EAA0B;AACtBD,mBAAOE,OAAO,GAAP,GAAaD,QAAQC,IAAR,CAAb,GAA6B,GAApC;AACH;AACD,YAAIC,MAAM,IAAIC,cAAJ,EAAV;AACAD,YAAIE,kBAAJ,GAAyB,YAAY;AACjC,gBAAIF,IAAIG,UAAJ,IAAkB,CAAtB,EAAyB;AACrB,oBAAIH,IAAII,MAAJ,IAAc,GAAd,IAAqBJ,IAAII,MAAJ,GAAa,GAAtC,EAA2C;AACvC,wBAAIC,WAAWL,IAAIM,YAAnB;AACA,wBAAID,QAAJ,EAAc;AACV,4BAAIE,eAAeC,KAAKC,KAAL,CAAWJ,QAAX,CAAnB;AACAnE,iCAASqE,YAAT;AACH,qBAHD,MAGO;AACH,4BAAGpE,KAAKX,KAAR,EAAc;AACVgB,oCAAQC,GAAR,CAAY,SAAZ,EAAsBoD,GAAtB;AACH;AACD3D,iCAAS,IAAT;AACH;AACJ,iBAXD,MAWO;AACH,wBAAGC,KAAKX,KAAR,EAAc;AACVgB,gCAAQC,GAAR,CAAY,MAAZ,EAAmBoD,GAAnB;AACH;AACD3D,6BAAS,IAAT;AACH;AACJ;AACJ,SApBD;AAqBA8D,YAAIU,IAAJ,CAAS,KAAT,EAAgBb,GAAhB,EAAqB,IAArB;AACAG,YAAIW,IAAJ;AACH,KArQK;;AAsQN;;;;;;;;;;;;;AAaAC,UAAM,cAAUf,GAAV,EAAeC,OAAf,EAAwB5D,QAAxB,EAAkC;AACpC,YAAIC,OAAO,IAAX;;AAEA2D,gBAAQrE,IAAR,GAAe,KAAKA,IAApB;AACAqE,gBAAQpE,OAAR,GAAkB,KAAKA,OAAvB;AACA;AACA,YAAImF,QAAQ,EAAZ;AACA,aAAK,IAAId,IAAT,IAAiBD,OAAjB,EAA0B;AACtBe,qBAASd,OAAO,GAAP,GAAaD,QAAQC,IAAR,CAAb,GAA6B,GAAtC;AACH;AACD;AACA,YAAIC,MAAM,IAAIC,cAAJ,EAAV;AACAD,YAAIE,kBAAJ,GAAyB,YAAY;AACjC,gBAAIF,IAAIG,UAAJ,IAAkB,CAAtB,EAAyB;AACrB,oBAAIH,IAAII,MAAJ,IAAc,GAAd,IAAqBJ,IAAII,MAAJ,GAAa,GAAtC,EAA2C;AACvC,wBAAIC,WAAWL,IAAIM,YAAnB;AACA;AACA,wBAAID,QAAJ,EAAc;AACV,4BAAIE,eAAeC,KAAKC,KAAL,CAAWJ,QAAX,CAAnB;AACAnE,iCAASqE,YAAT;AACH,qBAHD,MAGO;AACH,4BAAGpE,KAAKX,KAAR,EAAc;AACVgB,oCAAQC,GAAR,CAAY,SAAZ;AACH;AACDP,iCAAS,IAAT;AACH;AACJ,iBAZD,MAYO;AACH,wBAAGC,KAAKX,KAAR,EAAc;AACVgB,gCAAQC,GAAR,CAAY,MAAZ,EAAmBuD,GAAnB;AACH;AACD9D,6BAAS,IAAT;AACH;AACJ;AACJ,SArBD;AAsBA8D,YAAIU,IAAJ,CAAS,MAAT,EAAiBb,GAAjB,EAAsB,IAAtB;AACAG,YAAIc,gBAAJ,CAAqB,cAArB,EAAqC,mCAArC;AACAd,YAAIW,IAAJ,CAASE,KAAT,EApCoC,CAoCpB;AACnB,KAxTK;AAyTN;;;;;;;;AAQAzE,eAjUM,yBAiUQ;AACV,YAAIgC,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA3B,IAA0C,OAAOC,GAAGuC,gBAAV,KAA+B,UAA7E,EAAyF;AACrF,gBAAMC,gBAAgBxC,GAAGuC,gBAAH,EAAtB;AACAC,0BAAcC,gBAAd,CAA+B,UAAUtC,GAAV,EAAe;AAC1C,oBAAGxC,KAAKX,KAAR,EAAc;AACVgB,4BAAQC,GAAR,CAAY,aAAZ,EAA2BkC,IAAIuC,SAA/B;AACH;AACJ,aAJD;AAKAF,0BAAcG,aAAd,CAA4B,YAAY;AACpC,oBAAGhF,KAAKX,KAAR,EAAc;AACVgB,4BAAQC,GAAR,CAAY,mCAAZ;AACH;AACDuE,8BAAcI,WAAd;AACH,aALD;AAMAJ,0BAAcK,cAAd,CAA6B,YAAY;AACrC,oBAAGlF,KAAKX,KAAR,EAAc;AACVgB,4BAAQC,GAAR,CAAY,UAAZ;AACH;AACJ,aAJD;AAKH;AACJ,KArVK;;AAsVN;;;;;;;;;AASA6E,cA/VM,wBA+VM;AACR,eAAOzF,WAAW0F,OAAlB;AACH,KAjWK;;AAkWN;;;;;;;;;AASAC,cA3WM,wBA2WM;AACR,eAAO3F,WAAW4F,OAAlB;AACH,KA7WK;;;AAgXN;;;;;;;;;;AAUAC,eA1XM,uBA0XMC,MA1XN,EA0Xc9B,GA1Xd,EA0XmB;AACrB,YAAIhC,QAAQW,GAAGkD,WAAH,EAAZ;AACA7D,cAAM+D,MAAN,GAAe,YAAY;AACvB,gBAAIC,UAAU,IAAIzD,GAAG0D,SAAP,EAAd;AACAD,oBAAQE,eAAR,CAAwBlE,KAAxB;AACAgE,oBAAQG,mBAAR;AACAL,mBAAOM,WAAP,GAAqB,IAAI7D,GAAG8D,WAAP,CAAmBL,OAAnB,CAArB;AACH,SALD;AAMAhE,cAAMsE,GAAN,GAAYtC,GAAZ;AACH,KAnYK;;AAoYN;;;;;;;;AAQA7B,WA5YM,qBA4YG;AACL,YAAIoE,WAAW,KAAKC,OAAL,CAAa,UAAb,CAAf;AACA,YAAGD,QAAH,EAAY;AACR,mBAAOA,QAAP;AACH,SAFD,MAEK;AACD,mBAAO,IAAP;AACH;AACJ,KAnZK;;AAoZN;;;;;;;;;;AAUAE,WA9ZM,mBA8ZE9C,GA9ZF,EA8ZOJ,KA9ZP,EA8Za;AACfhB,WAAGC,GAAH,CAAOkE,YAAP,CAAoBD,OAApB,CAA4B9C,GAA5B,EAAiCJ,KAAjC;AACH,KAhaK;;AAiaN;;;;;;;;;;AAUAiD,WA3aM,mBA2aE7C,GA3aF,EA2aM;AACR,eAAOpB,GAAGC,GAAH,CAAOkE,YAAP,CAAoBF,OAApB,CAA4B7C,GAA5B,CAAP;AACH,KA7aK;;AA8aN;;;;;;;;;;;AAWAgD,aAzbM,qBAybItG,QAzbJ,EAyba;AACf,YAAIkC,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxCC,eAAGgE,SAAH,CAAa,UAASlG,CAAT,EAAW;AACpB;AACA;AACA;AACAJ,yBAASI,CAAT;AACH,aALD;AAMH;AACJ,KAlcK;;AAmcN;;;;;;;;;AASAmG,eA5cM,uBA4cMC,GA5cN,EA4cU;AACZ,YAAItE,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxCC,eAAGiE,WAAH,CAAe,EAAEE,SAASD,GAAX,EAAf;AACH;AACJ,KAhdK;;AAidN;AACAE,uBAldM,+BAkdcC,UAldd,EAkd0B3G,QAld1B,EAkdmC;AACrC,YAAIkC,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxCC,eAAGoE,mBAAH,CAAuB;AACnBE,4BAAYD,UADO;AAEnB/D,uBAFmB,mBAEXH,GAFW,EAEP;AACRzC,6BAASyC,GAAT;AACH,iBAJkB;AAKnBI,oBALmB,gBAKdJ,GALc,EAKV;AACLzC,6BAASyC,GAAT;AACH;AAPkB,aAAvB;AASH;AACJ,KA9dK;;AA+dN;AACAoE,uBAheM,+BAgecC,OAhed,EAgeuB9G,QAhevB,EAgegC;AAClC,YAAIkC,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxCC,eAAGuE,mBAAH,CAAuB;AACnBC,yBAASA,OADU;AAEnBlE,uBAFmB,mBAEXH,GAFW,EAEP;AACRzC,6BAASyC,GAAT;AACH,iBAJkB;AAKnBI,oBALmB,gBAKdJ,GALc,EAKV;AACLzC,6BAASyC,GAAT;AACH;AAPkB,aAAvB;AASH;AACJ,KA5eK;;AA6eN;AACAsE,wBA9eM,gCA8eeC,WA9ef,EA8e4BF,OA9e5B,EA8eqC9G,QA9erC,EA8e8C;AAChD,YAAIkC,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxCC,eAAGyE,oBAAH,CAAwB;AACpBC,6BAAaA,WADO;AAEpBF,yBAASA,OAFW;AAGpBlE,uBAHoB,mBAGZH,GAHY,EAGR;AACRzC,6BAASyC,GAAT;AACH,iBALmB;AAMpBI,oBANoB,gBAMfJ,GANe,EAMX;AACLzC,6BAASyC,GAAT;AACH;AARmB,aAAxB;AAUH;AACJ,KA3fK;;AA4fN;AACAwE,yBA7fM,iCA6fgBH,OA7fhB,EA6fyB9G,QA7fzB,EA6fkC;AACpC,YAAIkC,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxCC,eAAG2E,qBAAH,CAAyB;AACrBH,yBAASA,OADY;AAErBlE,uBAFqB,mBAEbH,GAFa,EAET;AACRzC,6BAASyC,GAAT;AACH,iBAJoB;AAKrBI,oBALqB,gBAKhBJ,GALgB,EAKZ;AACLzC,6BAASyC,GAAT;AACH;AAPoB,aAAzB;AASH;AACJ,KAzgBK;;AA0gBN;;;;;;;;;;;;;;;;;;;AAmBAyE,YA7hBM,oBA6hBGC,QA7hBH,EA6hBaC,KA7hBb,EA6hBoBC,KA7hBpB,EA6hB0B;AAC5BF,iBAASG,IAAT,CAAc,UAASC,CAAT,EAAWC,CAAX,EAAa;AACvB,gBAAIC,YAAY,CAAhB;AACA,gBAAIb,aAAaW,EAAEX,UAAnB;AACA,iBAAI,IAAI9F,IAAE,CAAV,EAAaA,IAAE8F,WAAWjG,MAA1B,EAAkCG,GAAlC,EAAsC;AAClC,oBAAG8F,WAAW9F,CAAX,EAAcwC,GAAd,IAAqB8D,KAAxB,EAA8B;AAC1BK,gCAAYb,WAAW9F,CAAX,EAAcoC,KAA1B;AACH;AACJ;;AAED,gBAAIwE,YAAY,CAAhB;AACAd,yBAAaY,EAAEZ,UAAf;AACA,iBAAI,IAAI9F,IAAE,CAAV,EAAaA,IAAE8F,WAAWjG,MAA1B,EAAkCG,GAAlC,EAAsC;AAClC,oBAAG8F,WAAW9F,CAAX,EAAcwC,GAAd,IAAqB8D,KAAxB,EAA8B;AAC1BM,gCAAYd,WAAW9F,CAAX,EAAcoC,KAA1B;AACH;AACJ;;AAED,gBAAGmE,KAAH,EAAS;AACL,uBAAOnG,SAASuG,SAAT,IAAsBvG,SAASwG,SAAT,CAA7B;AACH,aAFD,MAEK;AACD,uBAAOxG,SAASwG,SAAT,IAAsBxG,SAASuG,SAAT,CAA7B;AACH;AACJ,SAtBD;AAuBA,eAAON,QAAP;AACH,KAtjBK;;AAujBN;;;;;;;;;;;;;;;;;;;;;;;;AAwBAQ,cA/kBM,sBA+kBKR,QA/kBL,EA+kBcS,EA/kBd,EA+kBiB;AACnB,YAAIC,WAAW,EAAf;AACA,aAAI,IAAI/G,IAAE,CAAV,EAAaA,IAAEqG,SAASxG,MAAxB,EAAgCG,GAAhC,EAAoC;AAChC,gBAAGqG,SAASxG,MAAT,IAAmB,CAAtB,EAAwB;AACpB;AACA,oBAAGwG,SAASrG,CAAT,EAAYgH,SAAZ,IAAyBF,GAAGE,SAA5B,IAAyCX,SAASrG,CAAT,EAAYiB,QAAZ,IAAwB6F,GAAGG,QAAvE,EAAgF;AAC5EZ,6BAASrG,CAAT,EAAYkH,MAAZ,GAAqB,IAArB,CAD4E,CAClD;AAC7B;AACDH,2BAAWV,QAAX;AACA,qBAAI,IAAIrG,IAAE,CAAV,EAAaA,IAAE+G,SAASlH,MAAxB,EAAgCG,GAAhC,EAAoC;AAChC+G,6BAAS/G,CAAT,EAAYmH,IAAZ,GAAmBnH,CAAnB;AACH;AACJ,aATD,MASK;AACD,oBAAGqG,SAASrG,CAAT,EAAYgH,SAAZ,IAAyBF,GAAGE,SAA5B,IAAyCX,SAASrG,CAAT,EAAYiB,QAAZ,IAAwB6F,GAAGG,QAAvE,EAAgF;AAC5EZ,6BAASrG,CAAT,EAAYkH,MAAZ,GAAqB,IAArB,CAD4E,CAClD;AAC1B,wBAAGlH,KAAKqG,SAASxG,MAAT,GAAgB,CAAxB,EAA0B;AACtB;AACAwG,iCAASrG,CAAT,EAAYmH,IAAZ,GAAmBnH,CAAnB;AACAqG,iCAASrG,IAAE,CAAX,EAAcmH,IAAd,GAAqBnH,IAAE,CAAvB;AACAqG,iCAASrG,IAAE,CAAX,EAAcmH,IAAd,GAAqBnH,IAAE,CAAvB;AACA+G,iCAAS1G,IAAT,CAAcgG,SAASrG,IAAE,CAAX,CAAd;AACA+G,iCAAS1G,IAAT,CAAcgG,SAASrG,IAAE,CAAX,CAAd;AACA+G,iCAAS1G,IAAT,CAAcgG,SAASrG,CAAT,CAAd;AACH,qBARD,MAQM,IAAGA,KAAG,CAAN,EAAQ;AACV;AACAqG,iCAASrG,CAAT,EAAYmH,IAAZ,GAAmBnH,CAAnB;AACAqG,iCAASrG,IAAE,CAAX,EAAcmH,IAAd,GAAqBnH,IAAE,CAAvB;AACAqG,iCAASrG,IAAE,CAAX,EAAcmH,IAAd,GAAqBnH,IAAE,CAAvB;AACA+G,iCAAS1G,IAAT,CAAcgG,SAASrG,CAAT,CAAd;AACA+G,iCAAS1G,IAAT,CAAcgG,SAASrG,IAAE,CAAX,CAAd;AACA+G,iCAAS1G,IAAT,CAAcgG,SAASrG,IAAE,CAAX,CAAd;AACH,qBARK,MAQD;AACD;AACAqG,iCAASrG,IAAE,CAAX,EAAcmH,IAAd,GAAqBnH,IAAE,CAAvB;AACAqG,iCAASrG,CAAT,EAAYmH,IAAZ,GAAmBnH,CAAnB;AACAqG,iCAASrG,IAAE,CAAX,EAAcmH,IAAd,GAAqBnH,IAAE,CAAvB;AACA+G,iCAAS1G,IAAT,CAAcgG,SAASrG,IAAE,CAAX,CAAd;AACA+G,iCAAS1G,IAAT,CAAcgG,SAASrG,CAAT,CAAd;AACA+G,iCAAS1G,IAAT,CAAcgG,SAASrG,IAAE,CAAX,CAAd;AACH;AACD;AACH;AACJ;AAEJ;AACD,eAAO+G,QAAP;AACH,KA7nBK;;AA8nBN;;;;;;;;;;;;;;;;;;;;AAoBAK,eAlpBM,uBAkpBMC,GAlpBN,EAkpBWnI,QAlpBX,EAkpBoB;AACtB,YAAIC,OAAO,IAAX;AACA,YAAImI,WAAW,wDAAf;AACA,YAAIC,WAAW,MAAI,CAAnB;AACA,YAAIC,YAAYA,YAAU,CAA1B;AACA,YAAIC,aAAa,EAAjB;AACA,YAAIC,YAAY,EAAhB;AACA,YAAIC,aAAa,EAAjB;AACA,YAAGN,IAAIC,QAAP,EAAgB;AACZA,uBAAWD,IAAIC,QAAf;AACH;AACD,YAAGD,IAAIE,QAAP,EAAgB;AACZA,uBAAWF,IAAIE,QAAf;AACH;AACD,YAAGF,IAAIG,SAAP,EAAiB;AACbA,wBAAYH,IAAIG,SAAhB;AACH;AACD,YAAGH,IAAII,UAAP,EAAkB;AACdA,yBAAaJ,IAAII,UAAjB;AACH;AACD,YAAGJ,IAAIK,SAAP,EAAiB;AACbA,wBAAYL,IAAIK,SAAhB;AACH;AACD,YAAGL,IAAIM,UAAP,EAAkB;AACdA,yBAAaN,IAAIM,UAAjB;AACH;;AAED,YAAIvG,GAAGC,GAAH,CAAOC,QAAP,KAAoBF,GAAGC,GAAH,CAAOE,WAA/B,EAA4C;AACxC,gBAAI6D,WAAW,KAAKC,OAAL,CAAa,UAAb,CAAf;AACA,gBAAGD,QAAH,EAAY;AACRlG,yBAASsE,KAAKC,KAAL,CAAW2B,QAAX,CAAT;AACH,aAFD,MAEK;AACD,oBAAGjG,KAAKyI,MAAR,EAAe;AACXzI,yBAAKyI,MAAL,CAAYC,IAAZ;AACH,iBAFD,MAEK;AACDrG,uBAAGsG,aAAH,CAAiB;AACbhG,+BADa,mBACLH,GADK,EACD;AACRxC,iCAAKyI,MAAL,GAAcpG,GAAGuG,oBAAH,CAAwB;AAClCnI,sCAAM,OAD4B;AAElCiB,uCAAOyG,QAF2B;AAGlCU,uCAAO;AACHC,0CAAMtG,IAAIuG,WAAJ,GAAgB,CAAhB,GAAoBX,WAAS,CADhC;AAEHY,yCAAKxG,IAAIyG,YAAJ,GAAiB,CAAjB,GAAqBZ,YAAU,CAFjC;AAGHa,2CAAOd,QAHJ;AAIHe,4CAAQd;AAJL;AAH2B,6BAAxB,CAAd;AAUArI,iCAAKyI,MAAL,CAAYW,KAAZ,CAAkB,UAACC,IAAD,EAAU;AACxB;AACA;AACA;AACA;AACAhH,mCAAGiH,SAAH,CAAa,EAAC9H,OAAO,QAAR,EAAiB+H,MAAK,SAAtB,EAAgCC,UAAU,CAA1C,EAAb;AACAnH,mCAAGoH,UAAH,CAAc;AACV9G,2CADU,mBACF+G,KADE,EACI;AACV,4CAAGA,MAAMC,WAAN,CAAkB,gBAAlB,CAAH,EAAuC;AACnCtJ,oDAAQC,GAAR,CAAY,YAAZ;AACA+B,+CAAG7C,KAAH,CAAS;AACLmD,uDADK,mBACGiH,IADH,EACQ;AACT,wDAAIjG,UAAU;AACVkG,8DAAMD,KAAKC,IADD;AAEVC,iEAAST,KAAKS,OAFJ;AAGVC,4DAAIV,KAAKU,EAHC;AAIVC,uEAAeX,KAAKW,aAJV;AAKVC,mEAAWZ,KAAKY,SALN;;AAOV3B,oEAAYA,UAPF;AAQVC,mEAAWA,SARD;AASVC,oEAAYA;AAEhB;AAXc,qDAAd,CAYAxI,KAAKyE,IAAL,CAAUzE,KAAKb,GAAL,GAAWa,KAAKR,KAA1B,EAAiCmE,OAAjC,EAA0C,UAASuG,IAAT,EAAc;AACpD;AACA,4DAAGA,KAAK9J,CAAL,IAAU,CAAb,EAAe;AACXiC,+DAAG8H,SAAH;AACAnK,iEAAKmG,OAAL,CAAa,UAAb,EAAwB+D,KAAK/J,CAA7B;AACAH,iEAAKyI,MAAL,CAAY2B,IAAZ;AACArK,qEAASmK,KAAK/J,CAAd;AACH,yDALD,MAKK;AACDkC,+DAAGiH,SAAH,CAAa,EAAC9H,OAAO,SAAR,EAAb;AACH;AACJ,qDAVD;AAWH,iDAzBI;AA0BLoB,oDA1BK,kBA0BC;AACFP,uDAAGiH,SAAH,CAAa,EAAC9H,OAAO,SAAR,EAAb;AACAzB,6DAAS,KAAT;AACH;AA7BI,6CAAT;AA+BH,yCAjCD,MAiCK;AACDA,qDAAS,KAAT;AACH;AACJ;AAtCS,iCAAd;AAwCH,6BA9CD;AA+CAC,iCAAKyI,MAAL,CAAYC,IAAZ;AACH,yBA5DY;AA6Db9F,4BA7Da,kBA6DP;AACF7C,qCAAS,KAAT;AACH;AA/DY,qBAAjB;AAiEH;AACJ;AACJ;AACJ;AAzvBK,CAAV;AA+vBA;AACAsK,OAAOnL,GAAP,GAAaA,GAAb","file":"sdk.js","sourceRoot":"..\\..\\..\\..\\assets\\Sdk","sourcesContent":["/**\r\n1.安装apidoc，参考链接：\r\n\thttp://apidocjs.com\r\n2.按照格式弄好后，执行命令\r\n    apidoc -i ./apiTest/assets/Sdk -o api/\r\n    \r\n\r\n */\r\n\r\nvar md5 = require(\"md5\");\r\nvar mta = require(\"mta\");\r\nvar aldgame = require(\"ald-game\");\r\nvar sdk = { \r\n    md5: md5,\r\n    mta: mta,\r\n    // ip1: \"https://login.llewan.com\",\r\n    ip1: 'http://mock.eolinker.com/RiwKeAE4fb4e33cce254aee8509dbdd47b3898870569465?uri=https://login.llewan.com',\r\n    ip2: \"https://game.llewan.com\",\r\n\r\n    debug: false,                            //是否开启调试\r\n    game: \"\",\r\n    version: \"\",\r\n\r\n    login: '/Login/common',\r\n    Config: '/Config/common',\r\n    ConfigData: { \r\n        \"config1\": {},\r\n        \"config2\": {},\r\n    },\r\n    Share: \"/Share/common\",\r\n    ShareList: [],\r\n\r\n    /**\r\n     * @apiGroup A\r\n     * @apiName init\r\n     * @api {初始化sdk} 使用勇往sdk前，必须先初始化一次才能使用 init（初始化sdk）\r\n     *\r\n     * @apiParam {String} game 游戏标识\r\n     * @apiParam {String} version 版本\r\n     * @apiParam {Boolean} [debug=false] 是否开启调试\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * //.初始化游戏\r\n     *   sdk.init({\r\n            debug: true,         //.是否开启调试\r\n            app_name: \"xiao_xiao_yu_tang\",     //.游戏唯一标识\r\n            version: \"1.0.0\",   //.游戏版本\r\n        }, (res)=>{\r\n            console.log('sdk初始化结果：', res)\r\n        })\r\n     */\r\n    init(args, callback){\r\n        var self = this;\r\n        if(args.debug){\r\n            this.debug = args.debug;\r\n        }\r\n        if(args.game){\r\n            this.game = args.game;\r\n        }\r\n        if(args.version){\r\n            this.version = args.version;\r\n        }\r\n        this.checkUpdate();\r\n\r\n        //.获取后台配置信息\r\n        this.Get(this.ip2 + this.Config, {}, function (d) {\r\n            if (d && d.c == 1) {\r\n                self.ConfigData = d.d;\r\n                callback(true);\r\n            }else{\r\n                if(self.debug){\r\n                    console.log(\"获取游戏后台配置信息失败：\",d)\r\n                }\r\n                self.init(args, callback);\r\n            }\r\n        });\r\n\r\n        //.初始化分享\r\n        this.initShare();\r\n\r\n    },\r\n    initShare(){\r\n        var self = this;\r\n        //.获取后台分享信息\r\n        this.Get(this.ip2 + this.Share, {}, function (d) {\r\n            if (d && d.c == 1) {\r\n                self.ShareList = d.d;\r\n            }else{\r\n                console.log(\"获取后台分享信息失败：\",d)\r\n            }\r\n        });\r\n    },\r\n    getShareByWeight(type){\r\n        if(this.ShareList.length > 0){\r\n            var info = {};\r\n            var tArray = [];\r\n            for (var i = 0; i < share_list.length; i++) {\r\n                if (type == share_list[i].position) {\r\n                    share_list[i].weight = parseInt(share_list[i].weight);\r\n                    tArray.push(share_list[i]);\r\n                }\r\n            }\r\n            var iArray = [];\r\n            for (var i = 0; i < tArray.length; i++) {\r\n                for (var j = 0; j < tArray[i].weight; j++) {\r\n                    iArray.push(i);\r\n                }\r\n            }\r\n            var rI = iArray[parseInt(Math.random() * iArray.length)];\r\n            if(tArray[rI]){\r\n                info.title = tArray[rI].title;\r\n                info.imageUrl = tArray[rI].image;\r\n            }else{\r\n                info.title = \"小小鱼塘\";\r\n                info.imageUrl = \"\";\r\n            }\r\n            //.正则替换昵称\r\n            if(info.title.indexOf(\"&nick\") != -1){\r\n                info.title = info.title.replace(/&nick/g, this.getUser().nickname);\r\n            }\r\n            return info;\r\n        }else{\r\n            this.initShare();\r\n            return null;\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName shareAppMessage\r\n     * @api {分享} 微信分享 shareAppMessage(分享)\r\n     * @apiParam {int} type 后台自定义的分享类型；例如：0：右上角分享(只读)、1：普通分享 2：分享加金币\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.shareAppMessage  (1);\r\n     */\r\n    shareAppMessage(type){\r\n        \r\n    },\r\n    onShareAppMessage(type){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            //.微信右上角分享\r\n            wx.showShareMenu({withShareTicket:true})\r\n            wx.onShareAppMessage(function(res){\r\n                var shareItem = self.getShareByWeight();\r\n                return {\r\n                    title: shareItem.title,\r\n                    imageUrl: shareItem.imageUrl,\r\n                    query: shareItem.query,\r\n                    success(res){\r\n                        console.log(res)\r\n                    },\r\n                    fail(res){\r\n                        console.log(res)\r\n                    } \r\n                }\r\n            })\r\n        }\r\n    },\r\n    \r\n\r\n\r\n    /**\r\n     * @apiIgnore\r\n     * @apiGroup B\r\n     * @apiName initmta\r\n     * @api {初始化腾讯统计sdk} 参考链接http://mta.qq.com/wechat_mini/manage/ctr_sdk_help?app_id=500625714 initmta（腾讯统计）\r\n     * @apiParam {Object} args 参数\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * //.简单\r\n     * mta.App.init({\r\n     *     \"appID\":\"500618042\",\r\n     *     \"eventID\":\"500618044\"\r\n     * });\r\n     * //.高级\r\n     * mta.App.init({\r\n     *     \"appID\":\"500618042\",\r\n     *     \"eventID\":\"500618044\", // 高级功能-自定义事件统计ID，配置开通后在初始化处填写\r\n     *     \"lauchOpts\":options, //渠道分析,需在onLaunch方法传入options,如onLaunch:function(options){...}\r\n     *     \"statPullDownFresh\":true, // 使用分析-下拉刷新次数/人数，必须先开通自定义事件，并配置了合法的eventID\r\n     *     \"statShareApp\":true, // 使用分析-分享次数/人数，必须先开通自定义事件，并配置了合法的eventID\r\n     *     \"statReachBottom\":true // 使用分析-页面触底次数/人数，必须先开通自定义事件，并配置了合法的eventID\r\n     * });\r\n     */\r\n    initmta(args){\r\n        mta.App.init(args);\r\n        // 功能组件\r\n        // App id: 500625714\r\n        // App Secret key: 9b0fd6393ca10f5eebe0d1c659a460ab\r\n    },\r\n    /**\r\n     * @apiIgnore\r\n     * @apiGroup B\r\n     * @apiName setmta\r\n     * @api {腾讯统计埋点} 统计埋点 setmta\r\n     * @apiParam {String} name 腾讯后台查询\r\n     * @apiParam {String} value 腾讯后台查询\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.setmta(\"click\",\"p003\")\r\n     */\r\n    setmta(name, value){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            mta.Event.stat(name, { value: 'true' })\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup B\r\n     * @apiName setAld\r\n     * @api {阿拉丁埋点} 统计埋点(使用前请到阿拉丁注册游戏，并配置sdk/ald-game-conf.js) setAld（阿拉丁埋点）\r\n     * @apiParam {String} type 描述用户的动作名称，不超过255个字符,不支持数字,英文,中文,\"-\"、\"_\"、\"+\",以外的字符格式\r\n     * @apiParam {String} key 动作的参数，不超过255个字符，不支持数字，英文，中文，\"-\"、\"_\"、\"+\"，以外的字符格式\r\n     * @apiParam {String} value 动作的参数值，不超过255个字符，不支持数字，英文，中文，“-“、”_”、\"+\"，以外的字符格式\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * //使用前，在开发者设置中添加 request合法域名https://glog.aldwx.com\r\n     * //统计类型（点击）， 统计位置（开始游戏按钮），  统计参数（点了1次）\r\n     * sdk.setAld(\"click\", \"playButton\", \"1\")\r\n     */\r\n    setAld(type, key, value){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            // wx.aldSendEvent('事件名称',{'参数key' : '参数value'})、\r\n            wx.aldSendEvent(v1,  { v2 : v3 })\r\n        }\r\n    },\r\n\r\n\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName Get\r\n     * @api {Get} 发起网络请求 Get（发起Get请求）\r\n     * \r\n     * @apiParam {String} url 请求地址\r\n     * @apiParam {Object} reqData 请求参数\r\n     * @apiParam {Object} callback 不存在返回null\r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.Get(\"https://xxx.xxx\", { user_id: user_id }, function (d) {\r\n     *     console.log(d)\r\n     * });\r\n     */\r\n    Get(url, reqData, callback) {\r\n        var self = this;\r\n\r\n        reqData.game = this.game;\r\n        reqData.version = this.version;\r\n        url += \"?\";\r\n        for (var item in reqData) {\r\n            url += item + \"=\" + reqData[item] + \"&\";\r\n        }\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4) {\r\n                if (xhr.status >= 200 && xhr.status < 400) {\r\n                    var response = xhr.responseText;\r\n                    if (response) {\r\n                        var responseJson = JSON.parse(response);\r\n                        callback(responseJson);\r\n                    } else {\r\n                        if(self.debug){\r\n                            console.log(\"返回数据不存在\",url)\r\n                        }\r\n                        callback(null);\r\n                    }\r\n                } else {\r\n                    if(self.debug){\r\n                        console.log(\"请求失败\",url)\r\n                    }\r\n                    callback(null);\r\n                }\r\n            }\r\n        };\r\n        xhr.open(\"GET\", url, true);\r\n        xhr.send();\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName Post\r\n     * @api {Post} 发起网络请求 Post（发起Post请求）\r\n     * \r\n     * @apiParam {String} url 请求地址\r\n     * @apiParam {Object} reqData 请求参数\r\n     * @apiParam {Object} callback 不存在返回null\r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.Post(sdk.ip + sdk.common, { user_id: user_id }, function (d) {\r\n     *     console.log(d)\r\n     * });\r\n     */\r\n    Post: function (url, reqData, callback) {\r\n        var self = this;\r\n        \r\n        reqData.game = this.game;\r\n        reqData.version = this.version;\r\n        //1.拼接请求参数\r\n        var param = \"\";\r\n        for (var item in reqData) {\r\n            param += item + \"=\" + reqData[item] + \"&\";\r\n        }\r\n        //2.发起请求\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4) {\r\n                if (xhr.status >= 200 && xhr.status < 400) {\r\n                    var response = xhr.responseText;\r\n                    // console.log(response)\r\n                    if (response) {\r\n                        var responseJson = JSON.parse(response);\r\n                        callback(responseJson);\r\n                    } else {\r\n                        if(self.debug){\r\n                            console.log(\"返回数据不存在\")\r\n                        }\r\n                        callback(null);\r\n                    }\r\n                } else {\r\n                    if(self.debug){\r\n                        console.log(\"请求失败\",xhr)\r\n                    }\r\n                    callback(null);\r\n                }\r\n            }\r\n        };\r\n        xhr.open(\"POST\", url, true);\r\n        xhr.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\n        xhr.send(param);//reqData为字符串形式： \"key=value\"\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName checkUpdate\r\n     * @api {检测版本更新} 微信小游戏（冷启动的时候会检查，如果有更新则会重启小游戏进行更新） checkUpdate（版本更新）\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.checkUpdate();\r\n     */\r\n    checkUpdate() {\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME && typeof wx.getUpdateManager === 'function') {\r\n            const updateManager = wx.getUpdateManager()\r\n            updateManager.onCheckForUpdate(function (res) {\r\n                if(self.debug){\r\n                    console.log(\"请求完新版本信息的回调\", res.hasUpdate)\r\n                }\r\n            })\r\n            updateManager.onUpdateReady(function () {\r\n                if(self.debug){\r\n                    console.log(\"新的版本已经下载好，调用 applyUpdate 应用新版本并重启\")\r\n                }\r\n                updateManager.applyUpdate()\r\n            })\r\n            updateManager.onUpdateFailed(function () {\r\n                if(self.debug){\r\n                    console.log(\"新的版本下载失败\")\r\n                }\r\n            })\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName getConfig1\r\n     * @api {运营配置} 游戏后台配置信息，运营人员使用的通用配置开关 getConfig1（运营配置）\r\n     * @apiParam {Object} callback 不存在返回null\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * var d = sdk.getConfig1();\r\n     */\r\n    getConfig1(){\r\n        return ConfigData.config1;\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName getConfig2\r\n     * @api {程序配置} 游戏后台配置信息，程序员使用的游戏数据开关，可随便自定义数据：例如复活次数等 getConfig2（程序配置）\r\n     * @apiParam {Object} callback 不存在返回null\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * var d = sdk.getConfig2();\r\n     */\r\n    getConfig2(){\r\n        return ConfigData.config2;\r\n    },\r\n\r\n    \r\n    /**\r\n     * @apiGroup C\r\n     * @apiName createImage\r\n     * @api {显示网络图片} 微信小游戏加载图片 createImage（显示图片）\r\n     * @apiParam {cc.Sprite} sprite 显示图片的Sprite\r\n     * @apiParam {String} url 需要加载的图片地址\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * var data = sdk.createImage(advs);\r\n     */\r\n    createImage(sprite, url) {\r\n        let image = wx.createImage();\r\n        image.onload = function () {\r\n            let texture = new cc.Texture2D();\r\n            texture.initWithElement(image);\r\n            texture.handleLoadedTexture();\r\n            sprite.spriteFrame = new cc.SpriteFrame(texture);\r\n        };\r\n        image.src = url;\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName getUser\r\n     * @api {获取本地用户信息} 获取本地用户信息（登录成功后，会在本地存储用户信息） getUser（获取用户信息）\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * var user = sdk.getUser();\r\n     */\r\n    getUser(){\r\n        var userinfo = this.getItem('userinfo');\r\n        if(userinfo){\r\n            return userinfo;\r\n        }else{\r\n            return null;\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName setItem\r\n     * @api {set} 数据存储 setItem（存）\r\n     * @apiParam {String} key 键\r\n     * @apiParam {String} value 值\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.setItem(\"nick\",\"hello\")\r\n     */\r\n    setItem(key, value){\r\n        cc.sys.localStorage.setItem(key, value);\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName getItem\r\n     * @api {get} 数据存储 getItem（取）\r\n     * @apiParam {String} key 键\r\n     * @apiParam {String} value 值\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * var nick = sdk.getItem(\"nick\")\r\n     */\r\n    getItem(key){\r\n        return cc.sys.localStorage.getItem(key);\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName onMessage\r\n     * @api {主域监听子域发送的消息} 主域监听子域发送的消息 onMessage（监听消息）\r\n     * @apiParam {callback} callback 回调函数\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.onMessage((d)=>{\r\n     *     console.log(d)\r\n     * })\r\n     */\r\n    onMessage(callback){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.onMessage(function(d){\r\n                // if(d.message == \"common_back\"){//.子域: 返回子域首页\r\n                //     cc.director.loadScene(\"common_children\")\r\n                // }\r\n                callback(d)\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName postMessage\r\n     * @api {主域向子域发送消息} 主域向子域发送消息 postMessage（发送消息）\r\n     * @apiParam {String} msg 发送给子域的消息\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.postMessage(\"hello\")\r\n     */\r\n    postMessage(msg){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.postMessage({ message: msg });\r\n        }\r\n    },\r\n    //.主域上报数据:    对用户托管数据进行写数据操作，允许同时写多组 KV 数据。\r\n    setUserCloudStorage(kvDataList, callback){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.setUserCloudStorage({\r\n                KVDataList: kvDataList,\r\n                success(res){\r\n                    callback(res)\r\n                },\r\n                fail(res){\r\n                    callback(res)\r\n                }\r\n            })\r\n        }\r\n    },\r\n    //.获取当前用户托管数据当中对应 key 的数据。该接口只可在开放数据域下使用\r\n    getUserCloudStorage(keyList, callback){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.getUserCloudStorage({\r\n                keyList: keyList,\r\n                success(res){\r\n                    callback(res)\r\n                },\r\n                fail(res){\r\n                    callback(res)\r\n                }\r\n            })\r\n        }\r\n    },\r\n    //.在小游戏是通过群分享卡片打开的情况下，可以通过调用该接口获取群同玩成员的游戏数据。该接口只可在开放数据域下使用。\r\n    getGroupCloudStorage(shareTicket, keyList, callback){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.getGroupCloudStorage({\r\n                shareTicket: shareTicket,\r\n                keyList: keyList,\r\n                success(res){\r\n                    callback(res)\r\n                },\r\n                fail(res){\r\n                    callback(res)\r\n                }\r\n            })\r\n        }\r\n    },\r\n    //.拉取当前用户所有同玩好友的托管数据。该接口只可在开放数据域下使用\r\n    getFriendCloudStorage(keyList, callback){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.getFriendCloudStorage({\r\n                keyList: keyList,\r\n                success(res){\r\n                    callback(res)\r\n                },\r\n                fail(res){\r\n                    callback(res)\r\n                }\r\n            })\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName sortList\r\n     * @api {对子域数据进行排序} 对子域数据进行排序 sortList（子域排序）\r\n     * @apiParam {String} ListData 要排序的微信子域数据\r\n     * @apiParam {String} field 排序字段\r\n     * @apiParam {String} order 正序：true  ； 倒序：false\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * wx.getFriendCloudStorage({\r\n     *       keyList: [\"yw_score\"],\r\n     *       success(res){\r\n     *           var ListData = sdk.sortList(res.data, 'yw_score', true));\r\n     *       },\r\n     *       fail(){\r\n     *           console.log(res)\r\n     *       }\r\n     *})\r\n     */\r\n    sortList(ListData, field, order){\r\n        ListData.sort(function(a,b){\r\n            var AMaxScore = 0;\r\n            var KVDataList = a.KVDataList;\r\n            for(var i=0; i<KVDataList.length; i++){\r\n                if(KVDataList[i].key == field){\r\n                    AMaxScore = KVDataList[i].value;\r\n                }\r\n            }\r\n\r\n            var BMaxScore = 0;\r\n            KVDataList = b.KVDataList;\r\n            for(var i=0; i<KVDataList.length; i++){\r\n                if(KVDataList[i].key == field){\r\n                    BMaxScore = KVDataList[i].value;\r\n                }\r\n            }\r\n\r\n            if(order){\r\n                return parseInt(AMaxScore) - parseInt(BMaxScore);\r\n            }else{\r\n                return parseInt(BMaxScore) - parseInt(AMaxScore);\r\n            }\r\n        });\r\n        return ListData;\r\n    },\r\n    /**\r\n     * @apiIgnore\r\n     * @apiGroup C\r\n     * @apiName getMyRank3\r\n     * @api {排名与我相邻的3位玩家信息} 排名与我相邻的3位玩家信息 getMyRank3（Top3）\r\n     * @apiParam {String} ListData 要排序的微信子域数据\r\n     * @apiParam {String} me 我的子域信息\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * wx.getUserInfo({\r\n     *       openIdList: ['selfOpenId'],\r\n     *       lang: 'zh_CN',\r\n     *       success(res){\r\n     *          //.Top3\r\n     *          var dList = sdk.getMyRank3(dataList,res.data[0]);\r\n     *          console.log(dList)\r\n     *       },\r\n     *       fail(error) {\r\n     *          console.log(error)\r\n     *       }\r\n     * })\r\n     * \r\n     * \r\n     */\r\n    getMyRank3(ListData,me){\r\n        var dataList = [];\r\n        for(var i=0; i<ListData.length; i++){\r\n            if(ListData.length <= 3){\r\n                //.只有3个人或以下\r\n                if(ListData[i].avatarUrl == me.avatarUrl && ListData[i].nickname == me.nickName){\r\n                    ListData[i].isSelf = true;//.标记自己\r\n                }\r\n                dataList = ListData;\r\n                for(var i=0; i<dataList.length; i++){\r\n                    dataList[i].rank = i;\r\n                }                 \r\n            }else{\r\n                if(ListData[i].avatarUrl == me.avatarUrl && ListData[i].nickname == me.nickName){\r\n                    ListData[i].isSelf = true;//.标记自己\r\n                    if(i == ListData.length-1){\r\n                        //.自己分数最低\r\n                        ListData[i].rank = i;\r\n                        ListData[i-1].rank = i-1;\r\n                        ListData[i-2].rank = i-2;\r\n                        dataList.push(ListData[i-2])\r\n                        dataList.push(ListData[i-1])\r\n                        dataList.push(ListData[i])\r\n                    }else if(i==0){\r\n                        //.自己分数最高\r\n                        ListData[i].rank = i;\r\n                        ListData[i+1].rank = i+1;\r\n                        ListData[i+2].rank = i+2;\r\n                        dataList.push(ListData[i])\r\n                        dataList.push(ListData[i+1])\r\n                        dataList.push(ListData[i+2])\r\n                    }else{\r\n                        //.居中\r\n                        ListData[i-1].rank = i-1;\r\n                        ListData[i].rank = i;\r\n                        ListData[i+1].rank = i+1;\r\n                        dataList.push(ListData[i-1])\r\n                        dataList.push(ListData[i])\r\n                        dataList.push(ListData[i+1])\r\n                    }\r\n                    break;        \r\n                }\r\n            }\r\n               \r\n        }\r\n        return dataList;\r\n    },\r\n    /**\r\n     * @apiGroup C\r\n     * @apiName WeChatLogin\r\n     * @api {微信登录} 微信登录 WeChatLogin（登录）\r\n     * @apiParam {String} loginImg 登录按钮图片\r\n     * @apiParam {String} imgWidth 图片宽度\r\n     * @apiParam {String} imgHeight 图片高度\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * //.登录按钮图片、图片宽度、图片高度\r\n     *   sdk.WeChatLogin({loginImg: 'https://laixiao.github.io/lewan/html/img/btn_start.png', imgWidth:382, imgHeight: 164}, (d)=>{\r\n     *       if(d){\r\n     *           console.log(d)\r\n     *       }else{\r\n     *           console.log(\"登陆失败，请重试\")\r\n     *       }\r\n     *   });\r\n     * \r\n     * \r\n     */\r\n    WeChatLogin(obj, callback){\r\n        var self = this;\r\n        var loginImg = 'https://laixiao.github.io/lewan/html/img/btn_start.png';\r\n        var imgWidth = 382/2;\r\n        var imgHeight = imgHeight/2;\r\n        var referee_id = '';\r\n        var source_id = '';\r\n        var source_id2 = '';\r\n        if(obj.loginImg){\r\n            loginImg = obj.loginImg;\r\n        }\r\n        if(obj.imgWidth){\r\n            imgWidth = obj.imgWidth;\r\n        }\r\n        if(obj.imgHeight){\r\n            imgHeight = obj.imgHeight;\r\n        }\r\n        if(obj.referee_id){\r\n            referee_id = obj.referee_id;\r\n        }\r\n        if(obj.source_id){\r\n            source_id = obj.source_id;\r\n        }\r\n        if(obj.source_id2){\r\n            source_id2 = obj.source_id2;\r\n        }\r\n\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            var userinfo = this.getItem('userinfo');\r\n            if(userinfo){\r\n                callback(JSON.parse(userinfo))\r\n            }else{\r\n                if(self.button){\r\n                    self.button.show();\r\n                }else{\r\n                    wx.getSystemInfo({\r\n                        success(res){\r\n                            self.button = wx.createUserInfoButton({\r\n                                type: 'image',\r\n                                image: loginImg,\r\n                                style: {\r\n                                    left: res.screenWidth/2 - imgWidth/2,\r\n                                    top: res.screenHeight/2 - imgHeight/2,\r\n                                    width: imgWidth,\r\n                                    height: imgHeight,\r\n                                }\r\n                            })\r\n                            self.button.onTap((res1) => {\r\n                                // 处理用户拒绝授权的情况\r\n                                // if (res1.errMsg.indexOf('auth deny') > -1 || res1.errMsg.indexOf('auth denied') > -1 ) {\r\n                                //     wx.showToast();\r\n                                // }\r\n                                wx.showToast({title: '登录中...',icon:'loading',duration: 8});\r\n                                wx.getSetting({\r\n                                    success(auths){\r\n                                        if(auths.authSetting[\"scope.userInfo\"]){\r\n                                            console.log('===已经授权===');\r\n                                            wx.login({\r\n                                                success(res2){ \r\n                                                    var reqData = {   \r\n                                                        code: res2.code,\r\n                                                        rawData: res1.rawData,\r\n                                                        iv: res1.iv,\r\n                                                        encryptedData: res1.encryptedData,\r\n                                                        signature: res1.signature,\r\n\r\n                                                        referee_id: referee_id,\r\n                                                        source_id: source_id,\r\n                                                        source_id2: source_id2\r\n                                                    }\r\n                                                    // console.log('==登录参数==', reqData)\r\n                                                    self.Post(self.ip1 + self.login, reqData, function(data){\r\n                                                        // console.log('==登录结果==', data)\r\n                                                        if(data.c == 1){\r\n                                                            wx.hideToast();\r\n                                                            self.setItem('userinfo',data.d);\r\n                                                            self.button.hide();\r\n                                                            callback(data.d);\r\n                                                        }else{\r\n                                                            wx.showToast({title: '登录失败请重试'});\r\n                                                        }                \r\n                                                    });\r\n                                                },\r\n                                                fail(){\r\n                                                    wx.showToast({title: '登录失败请重试'});\r\n                                                    callback(false)\r\n                                                },\r\n                                            })\r\n                                        }else{\r\n                                            callback(false)\r\n                                        }\r\n                                    }\r\n                                })        \r\n                            })\r\n                            self.button.show()\r\n                        },\r\n                        fail(){\r\n                            callback(false)\r\n                        }\r\n                    })\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    \r\n\r\n};\r\n// module.exports = sdk;\r\nwindow.sdk = sdk;\r\n\r\n"]}