{"version":3,"sources":["..\\..\\..\\..\\assets\\sdk/assets\\sdk\\sdk.js"],"names":["md5","require","mta","sdk","ip","debug","app_name","version","login","init","args","console","log","checkUpdate","Get","url","reqData","callback","self","item","xhr","XMLHttpRequest","onreadystatechange","readyState","status","response","responseText","responseJson","JSON","parse","open","send","Post","param","setRequestHeader","cc","sys","platform","WECHAT_GAME","wx","getUpdateManager","updateManager","onCheckForUpdate","res","hasUpdate","onUpdateReady","applyUpdate","onUpdateFailed","getConfig","common","d","code","data","getShare","gameshare_list","list","getAdv","gameads","getShareByWeight","share_list","type","info","tArray","tCount","tRandom","Math","random","i","length","position","weight","parseInt","push","iArray","j","rI","title","imageUrl","image","indexOf","replace","getUser","nickname","getAdvByWeight","advs","createImage","sprite","onload","texture","Texture2D","initWithElement","handleLoadedTexture","spriteFrame","SpriteFrame","src","initmta","App","setmta","name","value","Event","stat","setItem","key","localStorage","getItem","onMessage","postMessage","msg","message","setUserCloudStorage","kvDataList","KVDataList","success","fail","getUserCloudStorage","keyList","getGroupCloudStorage","shareTicket","getFriendCloudStorage","sortList","ListData","field","order","sort","a","b","AMaxScore","BMaxScore","getMyRank3","me","dataList","avatarUrl","nickName","isSelf","rank","WeChatLogin","obj","loginImg","imgWidth","imgHeight","referee_id","source_id","source_id2","userinfo","button","show","getSystemInfo","createUserInfoButton","style","left","screenWidth","top","screenHeight","width","height","onTap","res1","showToast","icon","duration","getSetting","auths","authSetting","res2","rawData","iv","encryptedData","signature","c","hideToast","hide","window"],"mappings":"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","file":"sdk.js","sourceRoot":"..\\..\\..\\..\\assets\\sdk","sourcesContent":["/**\r\n1.安装apidoc，参考链接：\r\n\thttp://apidocjs.com\r\n2.按照格式弄好后，执行命令\r\n    apidoc -i ../demo/ -o api/\r\n    \r\n\r\n */\r\n\r\nvar md5 = require(\"md5\");\r\nvar mta = require(\"mta\");\r\nvar sdk = { \r\n    md5: md5,\r\n    mta: mta,\r\n    ip: \"https://game.zuiqiangyingyu.net\",\r\n\r\n    debug: false,                            //是否开启调试\r\n    app_name: \"\",\r\n    version: \"\",\r\n\r\n    login: 'https://login.llewan.com/Login/common',\r\n    // login: 'http://mock.eolinker.com/RiwKeAE4fb4e33cce254aee8509dbdd47b3898870569465?uri=https://login.llewan.com/Login/common',\r\n    \r\n\r\n    /**\r\n     * @apiGroup Get Start\r\n     * @apiName init\r\n     * @api {初始化sdk} 使用勇往sdk前，必须先初始化一次才能使用 init（初始化sdk）\r\n     *\r\n     * @apiParam {Boolean} [debug=false] 是否开启调试\r\n     * @apiParam {String} app_name 游戏标识\r\n     * @apiParam {String} version 版本\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.init({\r\n     *     debug: true,        //.是否开启调试\r\n     *     app_name: \"yt\",     //.游戏唯一标识\r\n     *     version: \"1.0.0\",   //.游戏版本\r\n     * })\r\n     */\r\n    init(args){\r\n        if(args.debug){\r\n            this.debug = args.debug;\r\n        }\r\n        if(args.app_name){\r\n            this.app_name = args.app_name;\r\n        }\r\n        if(args.version){\r\n            this.version = args.version;\r\n        }\r\n        if(this.debug){\r\n            console.log(\"勇往sdk初始化参数：\", args)\r\n        }\r\n\r\n        this.checkUpdate();\r\n    },\r\n    /**\r\n     * @apiGroup sdk\r\n     * @apiName Get\r\n     * @api {Get} 发起网络请求 Get\r\n     * \r\n     * @apiParam {String} url 请求地址\r\n     * @apiParam {Object} reqData 请求参数\r\n     * @apiParam {Object} callback 不存在返回null\r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.Get(\"https://xxx.xxx\", { user_id: user_id }, function (d) {\r\n     *     console.log(d)\r\n     * });\r\n     */\r\n    Get(url, reqData, callback) {\r\n        var self = this;\r\n        url += \"?\";\r\n        for (var item in reqData) {\r\n            url += item + \"=\" + reqData[item] + \"&\";\r\n        }\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4) {\r\n                if (xhr.status >= 200 && xhr.status < 400) {\r\n                    var response = xhr.responseText;\r\n                    if (response) {\r\n                        var responseJson = JSON.parse(response);\r\n                        callback(responseJson);\r\n                    } else {\r\n                        if(self.debug){\r\n                            console.log(\"返回数据不存在\",url)\r\n                        }\r\n                        callback(null);\r\n                    }\r\n                } else {\r\n                    if(self.debug){\r\n                        console.log(\"请求失败\",url)\r\n                    }\r\n                    callback(null);\r\n                }\r\n            }\r\n        };\r\n        xhr.open(\"GET\", url, true);\r\n        xhr.send();\r\n    },\r\n    /**\r\n     * @apiGroup sdk\r\n     * @apiName Post\r\n     * @api {Post} 发起网络请求 Post\r\n     * \r\n     * @apiParam {String} url 请求地址\r\n     * @apiParam {Object} reqData 请求参数\r\n     * @apiParam {Object} callback 不存在返回null\r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.Post(sdk.ip + sdk.common, { user_id: user_id }, function (d) {\r\n     *     console.log(d)\r\n     * });\r\n     */\r\n    Post: function (url, reqData, callback) {\r\n        var self = this;\r\n        //1.拼接请求参数\r\n        var param = \"\";\r\n        for (var item in reqData) {\r\n            param += item + \"=\" + reqData[item] + \"&\";\r\n        }\r\n        //2.发起请求\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4) {\r\n                if (xhr.status >= 200 && xhr.status < 400) {\r\n                    var response = xhr.responseText;\r\n                    // console.log(response)\r\n                    if (response) {\r\n                        var responseJson = JSON.parse(response);\r\n                        callback(responseJson);\r\n                    } else {\r\n                        if(self.debug){\r\n                            console.log(\"返回数据不存在\")\r\n                        }\r\n                        callback(null);\r\n                    }\r\n                } else {\r\n                    if(self.debug){\r\n                        console.log(\"请求失败\",xhr)\r\n                    }\r\n                    callback(null);\r\n                }\r\n            }\r\n        };\r\n        xhr.open(\"POST\", url, true);\r\n        xhr.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\n        xhr.send(param);//reqData为字符串形式： \"key=value\"\r\n    },\r\n    /**\r\n     * @apiGroup sdk\r\n     * @apiName checkUpdate\r\n     * @api {检测版本更新} 微信小游戏 checkUpdate（版本更新）\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.checkUpdate();\r\n     */\r\n    checkUpdate() {\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME && typeof wx.getUpdateManager === 'function') {\r\n            const updateManager = wx.getUpdateManager()\r\n            updateManager.onCheckForUpdate(function (res) {\r\n                if(self.debug){\r\n                    console.log(\"请求完新版本信息的回调\", res.hasUpdate)\r\n                }\r\n            })\r\n            updateManager.onUpdateReady(function () {\r\n                if(self.debug){\r\n                    console.log(\"新的版本已经下载好，调用 applyUpdate 应用新版本并重启\")\r\n                }\r\n                updateManager.applyUpdate()\r\n            })\r\n            updateManager.onUpdateFailed(function () {\r\n                if(self.debug){\r\n                    console.log(\"新的版本下载失败\")\r\n                }\r\n            })\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup sdk\r\n     * @apiName getConfig\r\n     * @api {游戏配置信息} 游戏配置信息 getConfig（获取配置）\r\n     * @apiParam {Object} callback 不存在返回null\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.getConfig(function (data) {\r\n     *     console.log(data)\r\n     * });\r\n     */\r\n    getConfig(callback){\r\n        var self = this;\r\n        this.Get(this.ip + this.common, { app_name: this.app_name, version: this.version }, function (d) {\r\n            if (d && d.code == 0) {\r\n                callback(d.data);\r\n            }else{\r\n                if(self.debug){\r\n                    console.log(\"操作失败\",d)\r\n                }\r\n                callback(null);\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     * @apiGroup sdk\r\n     * @apiName getShare\r\n     * @api {游戏分享信息} 游戏分享信息 getShare（获取分享）\r\n     * @apiParam {Object} callback 不存在返回null\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.getShare(function (data) {\r\n     *     console.log(data)\r\n     * });\r\n     */\r\n    getShare(callback){\r\n        this.Get(this.ip + this.gameshare_list, { app_name: this.app_name }, function (d) {\r\n            if (d && d.code == 0) {\r\n                callback(d.data.list);\r\n            } else {\r\n                if(self.debug){\r\n                    console.log(\"操作失败\",d)\r\n                }\r\n                callback(null);\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     * @apiGroup sdk\r\n     * @apiName getAdv\r\n     * @api {游戏广告信息} 游戏广告信息 getAdv（获取广告）\r\n     * @apiParam {Object} callback 不存在返回null\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.getAdv(function (data) {\r\n     *     console.log(data)\r\n     * });\r\n     */\r\n    getAdv(callback){\r\n        this.Get(this.ip + this.gameads, { app_name: this.app_name }, function (d) {\r\n            if (d && d.code == 0) {\r\n                callback(d.data.list);\r\n            }else{\r\n                if(self.debug){\r\n                    console.log(\"操作失败\",d)\r\n                }\r\n                callback(null);\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     * @apiGroup sdk\r\n     * @apiName getShareByWeight\r\n     * @api {根据权重获取分享语句} 根据权重获取分享语句 getShareByWeight\r\n     * @apiParam {Array} share_list 分享数组\r\n     * @apiParam {int} type 1 => '发起挑战', 2 => '群分享续命', 3 => '普通分享', 4 => '分享得金币'\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * var data = sdk.getShareByWeight(share_list, type);\r\n     */\r\n    getShareByWeight(share_list, type) {\r\n        var info = {};\r\n        var tArray = [];\r\n        var tCount = 0;\r\n        var tRandom = Math.random() * tCount;\r\n        for (var i = 0; i < share_list.length; i++) {\r\n            if (type == share_list[i].position) {\r\n                share_list[i].weight = parseInt(share_list[i].weight);\r\n                tArray.push(share_list[i]);\r\n            }\r\n        }\r\n        var iArray = [];\r\n        for (var i = 0; i < tArray.length; i++) {\r\n            for (var j = 0; j < tArray[i].weight; j++) {\r\n                iArray.push(i);\r\n            }\r\n        }\r\n        var rI = iArray[parseInt(Math.random() * iArray.length)];\r\n        if(tArray[rI]){\r\n            info.title = tArray[rI].title;\r\n            info.imageUrl = tArray[rI].image;\r\n        }else{\r\n            info.title = \"小小鱼塘\";\r\n            info.imageUrl = \"\";\r\n        }\r\n        //.正则替换昵称\r\n        if(info.title.indexOf(\"&nick\") != -1){\r\n            info.title = info.title.replace(/&nick/g, this.getUser().nickname);\r\n        }\r\n        return info;\r\n    },\r\n    /**\r\n     * @apiGroup sdk\r\n     * @apiName getAdvByWeight\r\n     * @api {根据权重获取分享语句} 根据权重获取分享语句 getAdvByWeight\r\n     * @apiParam {Array} share_list 广告数组\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * var data = sdk.getAdvByWeight(advs);\r\n     */\r\n    getAdvByWeight(advs) {\r\n        var tArray = [];\r\n        var tCount = 0;\r\n        var tRandom = Math.random() * tCount;\r\n        for (var i = 0; i < advs.length; i++) {\r\n            advs[i].weight = parseInt(advs[i].weight);\r\n            tArray.push(advs[i]);\r\n        }\r\n        //.随机数组\r\n        var iArray = [];\r\n        for (var i = 0; i < tArray.length; i++) {\r\n            for (var j = 0; j < tArray[i].weight; j++) {\r\n                iArray.push(i);\r\n            }\r\n        }\r\n        var rI = iArray[parseInt(Math.random() * iArray.length)];\r\n        return tArray[rI];\r\n    },\r\n    /**\r\n     * @apiGroup sdk\r\n     * @apiName createImage\r\n     * @api {微信小游戏跨域加载图片} 微信小游戏跨域加载图片 createImage（显示图片）\r\n     * @apiParam {cc.Sprite} sprite 显示图片的Sprite\r\n     * @apiParam {String} url 需要加载的图片地址\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * var data = sdk.createImage(advs);\r\n     */\r\n    createImage(sprite, url) {\r\n        let image = wx.createImage();\r\n        image.onload = function () {\r\n            let texture = new cc.Texture2D();\r\n            texture.initWithElement(image);\r\n            texture.handleLoadedTexture();\r\n            sprite.spriteFrame = new cc.SpriteFrame(texture);\r\n        };\r\n        image.src = url;\r\n    },\r\n    /**\r\n     * @apiGroup Get Start\r\n     * @apiName initmta\r\n     * @api {初始化腾讯统计sdk} 参考链接http://mta.qq.com/wechat_mini/manage/ctr_sdk_help?app_id=500625714 initmta（初始化统计）\r\n     * @apiParam {Object} args 参数\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * //.简单\r\n     * mta.App.init({\r\n     *     \"appID\":\"500618042\",\r\n     *     \"eventID\":\"500618044\"\r\n     * });\r\n     * //.高级\r\n     * mta.App.init({\r\n     *     \"appID\":\"500618042\",\r\n     *     \"eventID\":\"500618044\", // 高级功能-自定义事件统计ID，配置开通后在初始化处填写\r\n     *     \"lauchOpts\":options, //渠道分析,需在onLaunch方法传入options,如onLaunch:function(options){...}\r\n     *     \"statPullDownFresh\":true, // 使用分析-下拉刷新次数/人数，必须先开通自定义事件，并配置了合法的eventID\r\n     *     \"statShareApp\":true, // 使用分析-分享次数/人数，必须先开通自定义事件，并配置了合法的eventID\r\n     *     \"statReachBottom\":true // 使用分析-页面触底次数/人数，必须先开通自定义事件，并配置了合法的eventID\r\n     * });\r\n     */\r\n    initmta(args){\r\n        mta.App.init(args);\r\n        // 功能组件\r\n        // App id: 500625714\r\n        // App Secret key: 9b0fd6393ca10f5eebe0d1c659a460ab\r\n    },\r\n    /**\r\n     * @apiGroup Get Start\r\n     * @apiName setmta\r\n     * @api {统计埋点} 统计埋点 setmta（统计埋点）\r\n     * @apiParam {String} name 腾讯后台查询\r\n     * @apiParam {String} value 腾讯后台查询\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.setmta(\"click\",\"p003\")\r\n     */\r\n    setmta(name, value){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            mta.Event.stat(name, { value: 'true' })\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup sdk\r\n     * @apiName setItem\r\n     * @api {set} 数据存储 setItem（存）\r\n     * @apiParam {String} key 键\r\n     * @apiParam {String} value 值\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.setItem(\"nick\",\"hello\")\r\n     */\r\n    setItem(key, value){\r\n        cc.sys.localStorage.setItem(this.app_name + key, value);\r\n    },\r\n    /**\r\n     * @apiGroup sdk\r\n     * @apiName getItem\r\n     * @api {get} 数据存储 getItem（取）\r\n     * @apiParam {String} key 键\r\n     * @apiParam {String} value 值\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * var nick = sdk.getItem(\"nick\")\r\n     */\r\n    getItem(key){\r\n        return cc.sys.localStorage.getItem(this.app_name + key);\r\n    },\r\n    /**\r\n     * @apiGroup sdk\r\n     * @apiName onMessage\r\n     * @api {主域监听子域发送的消息} 主域监听子域发送的消息 onMessage（监听消息）\r\n     * @apiParam {callback} callback 回调函数\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.onMessage((d)=>{\r\n     *     console.log(d)\r\n     * })\r\n     */\r\n    onMessage(callback){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.onMessage(function(d){\r\n                // if(d.message == \"common_back\"){//.子域: 返回子域首页\r\n                //     cc.director.loadScene(\"common_children\")\r\n                // }\r\n                callback(d)\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup sdk\r\n     * @apiName postMessage\r\n     * @api {主域向子域发送消息} 主域向子域发送消息 postMessage（发送消息）\r\n     * @apiParam {String} msg 发送给子域的消息\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * sdk.postMessage(\"hello\")\r\n     */\r\n    postMessage(msg){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.postMessage({ message: msg });\r\n        }\r\n    },\r\n    //.主域上报数据:    对用户托管数据进行写数据操作，允许同时写多组 KV 数据。\r\n    setUserCloudStorage(kvDataList, callback){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.setUserCloudStorage({\r\n                KVDataList: kvDataList,\r\n                success(res){\r\n                    callback(res)\r\n                },\r\n                fail(res){\r\n                    callback(res)\r\n                }\r\n            })\r\n        }\r\n    },\r\n    //.获取当前用户托管数据当中对应 key 的数据。该接口只可在开放数据域下使用\r\n    getUserCloudStorage(keyList, callback){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.getUserCloudStorage({\r\n                keyList: keyList,\r\n                success(res){\r\n                    callback(res)\r\n                },\r\n                fail(res){\r\n                    callback(res)\r\n                }\r\n            })\r\n        }\r\n    },\r\n    //.在小游戏是通过群分享卡片打开的情况下，可以通过调用该接口获取群同玩成员的游戏数据。该接口只可在开放数据域下使用。\r\n    getGroupCloudStorage(shareTicket, keyList, callback){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.getGroupCloudStorage({\r\n                shareTicket: shareTicket,\r\n                keyList: keyList,\r\n                success(res){\r\n                    callback(res)\r\n                },\r\n                fail(res){\r\n                    callback(res)\r\n                }\r\n            })\r\n        }\r\n    },\r\n    //.拉取当前用户所有同玩好友的托管数据。该接口只可在开放数据域下使用\r\n    getFriendCloudStorage(keyList, callback){\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            wx.getFriendCloudStorage({\r\n                keyList: keyList,\r\n                success(res){\r\n                    callback(res)\r\n                },\r\n                fail(res){\r\n                    callback(res)\r\n                }\r\n            })\r\n        }\r\n    },\r\n    /**\r\n     * @apiGroup sdk\r\n     * @apiName sortList\r\n     * @api {对子域数据进行排序} 对子域数据进行排序 sortList（子域排序）\r\n     * @apiParam {String} ListData 要排序的微信子域数据\r\n     * @apiParam {String} field 排序字段\r\n     * @apiParam {String} order 正序：true  ； 倒序：false\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * wx.getFriendCloudStorage({\r\n     *       keyList: [\"yw_score\"],\r\n     *       success(res){\r\n     *           var ListData = sdk.sortList(res.data, 'yw_score', true));\r\n     *       },\r\n     *       fail(){\r\n     *           console.log(res)\r\n     *       }\r\n     *})\r\n     */\r\n    sortList(ListData, field, order){\r\n        ListData.sort(function(a,b){\r\n            var AMaxScore = 0;\r\n            var KVDataList = a.KVDataList;\r\n            for(var i=0; i<KVDataList.length; i++){\r\n                if(KVDataList[i].key == field){\r\n                    AMaxScore = KVDataList[i].value;\r\n                }\r\n            }\r\n\r\n            var BMaxScore = 0;\r\n            KVDataList = b.KVDataList;\r\n            for(var i=0; i<KVDataList.length; i++){\r\n                if(KVDataList[i].key == field){\r\n                    BMaxScore = KVDataList[i].value;\r\n                }\r\n            }\r\n\r\n            if(order){\r\n                return parseInt(AMaxScore) - parseInt(BMaxScore);\r\n            }else{\r\n                return parseInt(BMaxScore) - parseInt(AMaxScore);\r\n            }\r\n        });\r\n        return ListData;\r\n    },\r\n    /**\r\n     * @apiGroup sdk\r\n     * @apiName getMyRank3\r\n     * @api {排名与我相邻的3位玩家信息} 排名与我相邻的3位玩家信息 getMyRank3（Top3）\r\n     * @apiParam {String} ListData 要排序的微信子域数据\r\n     * @apiParam {String} me 我的子域信息\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * wx.getUserInfo({\r\n     *       openIdList: ['selfOpenId'],\r\n     *       lang: 'zh_CN',\r\n     *       success(res){\r\n     *          //.Top3\r\n     *          var dList = sdk.getMyRank3(dataList,res.data[0]);\r\n     *          console.log(dList)\r\n     *       },\r\n     *       fail(error) {\r\n     *          console.log(error)\r\n     *       }\r\n     * })\r\n     * \r\n     * \r\n     */\r\n    getMyRank3(ListData,me){\r\n        var dataList = [];\r\n        for(var i=0; i<ListData.length; i++){\r\n            if(ListData.length <= 3){\r\n                //.只有3个人或以下\r\n                if(ListData[i].avatarUrl == me.avatarUrl && ListData[i].nickname == me.nickName){\r\n                    ListData[i].isSelf = true;//.标记自己\r\n                }\r\n                dataList = ListData;\r\n                for(var i=0; i<dataList.length; i++){\r\n                    dataList[i].rank = i;\r\n                }                 \r\n            }else{\r\n                if(ListData[i].avatarUrl == me.avatarUrl && ListData[i].nickname == me.nickName){\r\n                    ListData[i].isSelf = true;//.标记自己\r\n                    if(i == ListData.length-1){\r\n                        //.自己分数最低\r\n                        ListData[i].rank = i;\r\n                        ListData[i-1].rank = i-1;\r\n                        ListData[i-2].rank = i-2;\r\n                        dataList.push(ListData[i-2])\r\n                        dataList.push(ListData[i-1])\r\n                        dataList.push(ListData[i])\r\n                    }else if(i==0){\r\n                        //.自己分数最高\r\n                        ListData[i].rank = i;\r\n                        ListData[i+1].rank = i+1;\r\n                        ListData[i+2].rank = i+2;\r\n                        dataList.push(ListData[i])\r\n                        dataList.push(ListData[i+1])\r\n                        dataList.push(ListData[i+2])\r\n                    }else{\r\n                        //.居中\r\n                        ListData[i-1].rank = i-1;\r\n                        ListData[i].rank = i;\r\n                        ListData[i+1].rank = i+1;\r\n                        dataList.push(ListData[i-1])\r\n                        dataList.push(ListData[i])\r\n                        dataList.push(ListData[i+1])\r\n                    }\r\n                    break;        \r\n                }\r\n            }\r\n               \r\n        }\r\n        return dataList;\r\n    },\r\n    /**\r\n     * @apiGroup sdk\r\n     * @apiName getMyRank3\r\n     * @api {微信登录} 微信登录 WeChatLogin（微信登录）\r\n     * @apiParam {String} ListData 要排序的微信子域数据\r\n     * @apiParam {String} me 我的子域信息\r\n     * \r\n     * @apiSuccessExample {json} 示例:\r\n     * wx.getUserInfo({\r\n     *       openIdList: ['selfOpenId'],\r\n     *       lang: 'zh_CN',\r\n     *       success(res){\r\n     *          //.Top3\r\n     *          var dList = sdk.getMyRank3(dataList,res.data[0]);\r\n     *          console.log(dList)\r\n     *       },\r\n     *       fail(error) {\r\n     *          console.log(error)\r\n     *       }\r\n     * })\r\n     * \r\n     * \r\n     */\r\n    WeChatLogin(obj, callback){\r\n        var self = this;\r\n        var loginImg = 'https://laixiao.github.io/lewan/html/img/btn_start.png';\r\n        var imgWidth = 382/2;\r\n        var imgHeight = imgHeight/2;\r\n        var referee_id = '';\r\n        var source_id = '';\r\n        var source_id2 = '';\r\n        if(obj.loginImg){\r\n            loginImg = obj.loginImg;\r\n        }\r\n        if(obj.imgWidth){\r\n            imgWidth = obj.imgWidth;\r\n        }\r\n        if(obj.imgHeight){\r\n            imgHeight = obj.imgHeight;\r\n        }\r\n        if(obj.referee_id){\r\n            referee_id = obj.referee_id;\r\n        }\r\n        if(obj.source_id){\r\n            source_id = obj.source_id;\r\n        }\r\n        if(obj.source_id2){\r\n            source_id2 = obj.source_id2;\r\n        }\r\n\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            var userinfo = this.getItem('userinfo');\r\n            if(userinfo){\r\n                callback(JSON.parse(userinfo))\r\n            }else{\r\n                if(self.button){\r\n                    self.button.show();\r\n                }else{\r\n                    wx.getSystemInfo({\r\n                        success(res){\r\n                            self.button = wx.createUserInfoButton({\r\n                                type: 'image',\r\n                                image: loginImg,\r\n                                style: {\r\n                                    left: res.screenWidth/2 - imgWidth/2,\r\n                                    top: res.screenHeight/2 - imgHeight/2,\r\n                                    width: imgWidth,\r\n                                    height: imgHeight,\r\n                                }\r\n                            })\r\n                            self.button.onTap((res1) => {\r\n                                // 处理用户拒绝授权的情况\r\n                                // if (res1.errMsg.indexOf('auth deny') > -1 || res1.errMsg.indexOf('auth denied') > -1 ) {\r\n                                //     wx.showToast();\r\n                                // }\r\n                                wx.showToast({title: '登录中...',icon:'loading',duration: 8});\r\n                                wx.getSetting({\r\n                                    success(auths){\r\n                                        if(auths.authSetting[\"scope.userInfo\"]){\r\n                                            console.log('===已经授权===');\r\n                                            wx.login({\r\n                                                success(res2){ \r\n                                                    var reqData = {   \r\n                                                        code: res2.code,\r\n                                                        rawData: res1.rawData,\r\n                                                        iv: res1.iv,\r\n                                                        encryptedData: res1.encryptedData,\r\n                                                        signature: res1.signature,\r\n\r\n                                                        referee_id: referee_id,\r\n                                                        source_id: source_id,\r\n                                                        source_id2: source_id2\r\n                                                    }\r\n                                                    // console.log('==登录参数==', reqData)\r\n                                                    self.Post(self.login, reqData, function(data){\r\n                                                        // console.log('==登录结果==', data)\r\n                                                        if(data.c == 1){\r\n                                                            wx.hideToast();\r\n                                                            self.setItem('user',data.d);\r\n                                                            self.button.hide();\r\n                                                            callback(data.d);\r\n                                                        }else{\r\n                                                            wx.showToast({title: '登录失败请重试'});\r\n                                                        }                \r\n                                                    });\r\n                                                },\r\n                                                fail(){\r\n                                                    wx.showToast({title: '登录失败请重试'});\r\n                                                    callback(false)\r\n                                                },\r\n                                            })\r\n                                        }else{\r\n                                            callback(false)\r\n                                        }\r\n                                    }\r\n                                })        \r\n                            })\r\n                            self.button.show()\r\n                        },\r\n                        fail(){\r\n                            callback(false)\r\n                        }\r\n                    })\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    \r\n\r\n};\r\n// module.exports = sdk;\r\nwindow.sdk = sdk;\r\n\r\n"]}