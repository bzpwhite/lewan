{"version":3,"sources":["Main.js"],"names":["cc","Class","extends","Component","properties","Rank","Node","Top3","GroupRank","onLoad","start","self","kvDataList","Array","push","key","value","parseInt","Math","random","sdk","setUserCloudStorage","res","console","log","sys","platform","WECHAT_GAME","wx","showShareMenu","withShareTicket","option","getLaunchOptionsSync","showGroupRank","onShow","update","dt","showRank","active","postMessage","scene","hideRank","showTop3","hideTop3","shareGroupRank","shareAppMessage","title","imageUrl","query","showModal","content","showCancel","confirmText","t","shareTicket","hideGroupRank"],"mappings":"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","file":"Main.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["//参考文档：https://github.com/pandamicro/creator-docs/blob/next/zh/publish/publish-wechatgame-sub-domain.md\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        Rank: cc.Node,\n        Top3: cc.Node,\n        GroupRank: cc.Node,\n\n    },\n\n    // use this for initialization\n    onLoad: function () {\n\n    },\n\n    start(){\n        var self = this;\n        \n        //.主域上报数据\n        var kvDataList = new Array();\n        kvDataList.push({ key:\"nick\", value: \"laixiao\"});\n        kvDataList.push({ key:\"avatar\", value: \"https://wx.qlogo.cn/mmopen/vi_32/78vDM2vOOAhAicj5YIPYKucDIx2VMdHGibLqZLSbBR9icgncZ3iaOibxEiaXEicq9Jmla0oGQfPY1lOTCOOU4PDXDUaog/0\"});\n        kvDataList.push({ key:\"score\", value: \"\"+ parseInt(Math.random()*1000)});//parseInt(Math.random()*1000)\n        sdk.setUserCloudStorage(kvDataList, (res)=>{\n            console.log('主域上报数据结果：', res)\n        })\n\n        \n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\n            //.显示当前页面右上角的转发按钮\n            wx.showShareMenu({ withShareTicket: true })\n            //.获取启动参数\n            var option = wx.getLaunchOptionsSync();\n            this.showGroupRank(option);\n            wx.onShow((res)=>{\n                self.showGroupRank(res);\n            });\n        }\n\n    },\n\n    // called every frame\n    update: function (dt) {\n\n    },\n\n    //1.好友排行\n    showRank(){\n        this.Rank.active = true;\n        sdk.postMessage({ scene: 'showRank' });\n    },\n    hideRank(){\n        this.Rank.active = false;\n        sdk.postMessage({ scene: 'hide' });\n    },\n    \n    //2.Top3排行\n    showTop3(){\n        this.Top3.active = true;\n        sdk.postMessage({ scene: 'showTop3' });\n    },\n    hideTop3(){\n        this.Top3.active = false;\n        sdk.postMessage({ scene: 'hide' });\n    },\n\n    //3.群排行\n    shareGroupRank(){\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\n            wx.shareAppMessage({\n                title: \"请点击分享卡片，查看群排名\",\n                imageUrl: '',\n                query: 't=rank'\n            })\n            wx.showModal({\n                title: '提示',\n                content: '请通过点击分享出去的消息查看群排名',\n                showCancel: false,\n                confirmText: '知道了'\n            })\n        }\n    },\n    showGroupRank(option){\n        if(option.query && option.query.t == 'rank'){\n            this.GroupRank.active = true;\n            sdk.postMessage({ scene: 'showGroupRank', shareTicket: option.shareTicket });\n        }\n    },\n    hideGroupRank(){\n        this.GroupRank.active = false;\n        sdk.postMessage({ scene: 'hide' });\n    },\n    \n    \n    \n\n\n});\n"]}